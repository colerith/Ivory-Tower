[
    {
        "id": "429dbe1d-ef08-407e-b731-cd1ed9c3204b",
        "scriptName": "【MoM】[1]清除多余内容（0117）",
        "findRegex": "/\\s?<finish>[\\s\\S]*</finish>|\\s?<disclaimer>[\\s\\S]*</disclaimer>|\\s?<!--[\\s\\S]*?-->|(?<=<p style)-/gi",
        "replaceString": "",
        "trimStrings": [],
        "placement": [
            2
        ],
        "disabled": false,
        "markdownOnly": true,
        "promptOnly": true,
        "runOnEdit": true,
        "substituteRegex": 0,
        "minDepth": null,
        "maxDepth": null
    },
    {
        "id": "12675bb4-60f9-4cf6-b97a-1d5f354fc1cb",
        "scriptName": "【MoM】[2]8楼外只发送摘要（1117）",
        "findRegex": "/^[\\s\\S]*?(<meow_FM>[\\s\\S]*?<\\/meow_FM>)[\\s\\S]*$/i",
        "replaceString": "$1",
        "trimStrings": [],
        "placement": [
            2
        ],
        "disabled": false,
        "markdownOnly": false,
        "promptOnly": true,
        "runOnEdit": true,
        "substituteRegex": 0,
        "minDepth": 8,
        "maxDepth": null
    },
    {
        "id": "58598443-86ba-42a4-9985-02dcd4588d3c",
        "scriptName": "【MoM】[3]10楼外角色关系、绝密档案、伏笔不发送（0117）",
        "findRegex": "/(?<=<meow_FM>[\\s\\S]*?)relation[:：][\\s\\S]*?(?=</meow_FM)/i",
        "replaceString": "",
        "trimStrings": [],
        "placement": [
            2
        ],
        "disabled": false,
        "markdownOnly": false,
        "promptOnly": true,
        "runOnEdit": true,
        "substituteRegex": 0,
        "minDepth": 10,
        "maxDepth": null
    },
    {
        "id": "0476bd4a-c0a2-4e05-9d8b-be5c8ae439d3",
        "scriptName": "【MoM】[4]极光小剧场修正vh（0903）",
        "disabled": false,
        "runOnEdit": true,
        "findRegex": "/height:\\s*\\d+vh/g",
        "replaceString": "height: auto",
        "trimStrings": [],
        "placement": [
            2
        ],
        "substituteRegex": 0,
        "minDepth": null,
        "maxDepth": null,
        "markdownOnly": true,
        "promptOnly": false
    },
    {
        "id": "f300ff90-2f50-41c1-be71-78b8bed98451",
        "scriptName": "【MoM】[5]不发送多余内容（0106）",
        "findRegex": "/<snow>[\\s\\S]*?<\\/snow>|/<snow_rules>[\\s\\S]*?<\\/snow_rules>|<echo>[\\s\\S]*?<\\/echo>|<ice>[\\s\\S]*?<\\/ice>|<gossip>[\\s\\S]*?</gossip>|/<gossip_rules>[\\s\\S]*?<\\/gossip_rules>|<branches>[\\s\\S]*?</branches>|<details>[\\s\\S]*?<\\/summary>|<\\/details>|<p\\s+style[^>]*>|<\\/p>/gi",
        "replaceString": "",
        "trimStrings": [],
        "placement": [
            2
        ],
        "disabled": false,
        "markdownOnly": false,
        "promptOnly": true,
        "runOnEdit": true,
        "substituteRegex": 0,
        "minDepth": null,
        "maxDepth": null
    },
    {
        "id": "97bdd080-eded-47ef-ac62-47308018cb41",
        "scriptName": "象牙塔可选-隐藏thinking（自动解析失败开启）",
        "findRegex": "/<thinking>([\\s\\S]*?)<\\/thinking>/g",
        "replaceString": "",
        "trimStrings": [],
        "placement": [
            2
        ],
        "disabled": false,
        "markdownOnly": true,
        "promptOnly": true,
        "runOnEdit": true,
        "substituteRegex": 0,
        "minDepth": null,
        "maxDepth": null
    },
    {
        "id": "0436e218-bda4-47a8-ae9c-4408bd49aeb7",
        "scriptName": "象牙塔可选-文字顶部状态栏（1224）",
        "findRegex": "<podcast>\\s*(?!<p)(.*)\\s+(.*)\\s+(.*)\\s+(.*)\\s+(.*)\\s*<\\/podcast>",
        "replaceString": "<podcast>\n<p style=\"font-size: 0.9em; text-align: center;\">$1</p>\n<p style=\"font-size: 2em; line-height:1.2; text-align: center;\">$2</p>\n<p style=\"font-size: 1.5em; line-height:1.2; text-align: center;\">$3</p>\n<p style=\"text-align: center;\">$4</p>\n<p style=\"text-align: center;\">$5</p>\n</podcast>",
        "trimStrings": [],
        "placement": [
            2
        ],
        "disabled": false,
        "markdownOnly": true,
        "promptOnly": false,
        "runOnEdit": true,
        "substituteRegex": 0,
        "minDepth": null,
        "maxDepth": null
    },
    {
        "id": "03ce4f9f-acb0-477b-a815-4c915a17c6ee",
        "scriptName": "象牙塔可选-捕获用户输入(不读指令开)",
        "findRegex": "^([\\s\\S]*)$",
        "replaceString": "以下是求索者的本轮最新输入，你必须基于本回复和结合上文，正确输出新内容，禁止重复输出之前的内容、跳跃回复其他输入：\n<user_input>  \n$1\n</user_input>",
        "trimStrings": [],
        "placement": [
            1
        ],
        "disabled": true,
        "markdownOnly": false,
        "promptOnly": true,
        "runOnEdit": true,
        "substituteRegex": 0,
        "minDepth": null,
        "maxDepth": 1
    },
    {
        "id": "cb4fd6e4-430d-400b-8420-2da971321b80",
        "scriptName": "象牙塔可选-不发送以前的用户输入",
        "disabled": true,
        "runOnEdit": true,
        "findRegex": "^([\\s\\S]*)$",
        "replaceString": "",
        "trimStrings": [],
        "placement": [
            1
        ],
        "substituteRegex": 0,
        "minDepth": 1,
        "maxDepth": null,
        "markdownOnly": false,
        "promptOnly": true
    },
    {
        "id": "f52bbc63-ae1a-461b-8d3a-66632b643e0e",
        "scriptName": "象牙塔美化-心绪回响|通用（0106） @电波系",
        "findRegex": "/<echo>\\s+([\\s\\S]*?)</echo>/gi",
        "replaceString": "```html\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n<meta charset=\"UTF-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<title>心绪回响 @电波系</title>\n\n<link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n<link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n<link href=\"https://fonts.googleapis.com/css2?family=Libre+Barcode+128&family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap\" rel=\"stylesheet\">\n<link href=\"https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Caveat:wght@500&family=JetBrains+Mono:wght@400;700&family=Noto+Serif+SC:wght@300;700&family=Libre+Barcode+128&display=swap\" rel=\"stylesheet\">\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\n<link href=\"https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;700&family=Playfair+Display:ital,wght@0,400;1,400&family=Cedarville+Cursive&display=swap\" rel=\"stylesheet\">\n<link href=\"https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Cinzel:wght@400;700&display=swap\" rel=\"stylesheet\">\n<link rel=\"preload\" as=\"style\" crossorigin\n    href=\"https://fontsapi.zeoseven.com/570/main/result.css\"\n    onload=\"this.rel='stylesheet'\"\n    onerror=\"this.href='https://fontsapi-storage.zeoseven.com/570/main/result.css'\" />\n<noscript>\n    <link rel=\"stylesheet\" href=\"https://fontsapi.zeoseven.com/570/main/result.css\" />\n</noscript>\n\n<style>\n    body { \n        display: flex; \n        justify-content: center; \n        align-items: center; \n        margin: 0; \n        padding: 10px; \n        box-sizing: border-box; \n        font-family: 'Noto Serif SC', serif;\n        background: transparent !important;\n    }\n\n    .reverie-container {\n        max-width: 550px;\n        margin: 0 auto;\n        display: none; \n    }\n    .reverie-container.active { display: block; }\n\n    /* =================================================================== */\n    /* 1. 模式一：豪华概念店小票 */\n    /* =================================================================== */\n    .style-excerpt .card-content-wrapper {\n        position: relative;\n        background: #fcfbf9;\n        width: 100%;\n        max-width: 360px;\n        margin: 0 auto;\n        padding: 25px 20px 30px 20px;\n        box-shadow: 0 8px 25px rgba(0,0,0,0.12);\n        font-family: 'Space Mono', monospace;\n        color: #2a2a2a;\n        line-height: 1.4;\n        background-image: url(\"data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.04'/%3E%3C/svg%3E\");\n    }\n\n    .style-excerpt .card-content-wrapper::before,\n    .style-excerpt .card-content-wrapper::after {\n        content: \"\"; position: absolute; left: 0; width: 100%; height: 12px;\n        background-color: transparent;\n        background: #fcfbf9;\n        -webkit-mask-image: linear-gradient(135deg, black 50%, transparent 50%), linear-gradient(45deg, black 50%, transparent 50%);\n        mask-image: linear-gradient(135deg, black 50%, transparent 50%), linear-gradient(45deg, black 50%, transparent 50%);\n        -webkit-mask-position: top left, top right; mask-position: top left, top right;\n        -webkit-mask-size: 15px 15px; mask-size: 15px 15px;\n        -webkit-mask-repeat: repeat-x; mask-repeat: repeat-x;\n        z-index: 2;\n    }\n    .style-excerpt .card-content-wrapper::before { top: -12px; transform: rotate(180deg); }\n    .style-excerpt .card-content-wrapper::after { bottom: -12px; }\n\n    .style-excerpt .receipt-header { text-align: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px dashed #bbb; }\n    .style-excerpt .brand-logo { font-family: 'Noto Serif SC', serif; font-weight: 900; font-size: 1.8em; letter-spacing: 3px; margin: 0; line-height: 1; }\n    .style-excerpt .store-info { font-size: 0.75em; color: #888; margin-top: 4px; text-transform: uppercase; }\n    .style-excerpt .meta-line { display: flex; justify-content: space-between; font-size: 0.75em; color: #666; margin-bottom: 15px; border-bottom: 1px dashed #bbb; padding-bottom: 5px; }\n    .style-excerpt .item-section { margin-bottom: 15px; }\n    .style-excerpt .item-row { display: flex; align-items: baseline; }\n    .style-excerpt .qty { width: 35px; font-weight: bold; flex-shrink: 0; }\n    .style-excerpt .desc { flex-grow: 1; }\n    .style-excerpt .main-content { font-weight: 700; font-size: 1.1em; margin-bottom: 4px; display: block; }\n    .style-excerpt .sub-content { font-size: 0.9em; color: #555; font-style: italic; }\n    .style-excerpt .price { width: 40px; text-align: right; font-weight: bold; flex-shrink: 0; }\n    .style-excerpt .simple-note { margin-top: 8px; font-size: 0.85em; color: #666; background: rgba(0,0,0,0.03); padding: 6px; border-radius: 4px; }\n    .style-excerpt .total-section { border-top: 2px solid #2a2a2a; padding-top: 8px; margin-top: 15px; margin-bottom: 15px; }\n    .style-excerpt .total-row { display: flex; justify-content: space-between; font-size: 1.2em; font-weight: 900; }\n    .style-excerpt .card-info { font-size: 0.7em; color: #888; text-align: right; margin-top: 2px; }\n    .style-excerpt .receipt-footer { text-align: center; opacity: 0.8; }\n    .style-excerpt .barcode-font { font-family: 'Libre Barcode 128', cursive; font-size: 2.8em; line-height: 0.8; margin: 5px 0; transform: scaleY(1.1); }\n\n\n    /* =================================================================== */\n    /* 2. 模式三：高仿真登机牌 */\n    /* =================================================================== */\n    .style-recommendation .card-content-wrapper {\n        display: flex;\n        width: 100%;\n        max-width: 600px;\n        filter: drop-shadow(0px 8px 20px rgba(0, 50, 150, 0.2));\n        background: transparent;\n        font-family: 'Inter', system-ui, sans-serif;\n        color: #333;\n        --card-radius: 20px;\n        --stub-width: 140px;\n    }\n\n    .style-recommendation .card-content-wrapper:hover {\n        transform: translateY(-4px); \n    }\n\n    .style-recommendation .texture-overlay {\n        position: absolute; top: 0; left: 0; right: 0; bottom: 0;\n        opacity: 0.06; pointer-events: none; z-index: 1;\n        background-image: url(\"data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='1'/%3E%3C/svg%3E\");\n        border-radius: inherit;\n    }\n\n    .style-recommendation .ticket-main {\n        flex: 1; min-width: 0; background-color: #ffffff; padding: 30px; position: relative;\n        border-radius: var(--card-radius) 0 0 var(--card-radius);\n    }\n    .style-recommendation .ticket-stub {\n        flex: 0 0 var(--stub-width); background: linear-gradient(135deg, #007aff 0%, #0050a0 100%);\n        color: white; padding: 20px 15px; position: relative;\n        border-radius: 0 var(--card-radius) var(--card-radius) 0;\n        display: flex; flex-direction: column; justify-content: space-between; text-align: center; overflow: hidden;\n        box-shadow: inset 2px 0 10px rgba(0,0,0,0.1), inset -2px -2px 10px rgba(255,255,255,0.1);\n    }\n    .style-recommendation .ticket-stub::before {\n        content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;\n        background: linear-gradient(45deg, transparent 40%, rgba(255,255,255,0.1) 45%, rgba(255,255,255,0.3) 50%, rgba(255,255,255,0.1) 55%, transparent 60%);\n        transform: rotate(25deg); pointer-events: none; z-index: 2; mix-blend-mode: overlay;\n    }\n    .style-recommendation .perforation-line {\n        position: absolute; top: 15px; bottom: 15px; right: 0; width: 0; border-right: 2px dashed #e0e0e0; z-index: 2;\n    }\n    .style-recommendation .ticket-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; padding-bottom: 12px; border-bottom: 2px solid #f2f2f7; }\n    .style-recommendation .airline-brand { font-weight: 800; font-size: 1.1em; color: #007aff; display: flex; align-items: center; gap: 8px; }\n    .style-recommendation .priority-tag { font-size: 0.65em; font-weight: 700; color: #007aff; background: rgba(0, 122, 255, 0.1); padding: 5px 10px; border-radius: 20px; }\n    .style-recommendation .content-body { margin-bottom: 30px; position: relative; z-index: 3; }\n    .style-recommendation .rec-label { font-size: 0.7em; color: #9eaab5; font-weight: 700; letter-spacing: 1px; margin-bottom: 6px; }\n    .style-recommendation .rec-title { font-size: 1.6em; font-weight: 800; color: #111; line-height: 1.2; margin-bottom: 5px; }\n    .style-recommendation .rec-artist { font-size: 1em; color: #007aff; font-weight: 600; }\n    .style-recommendation .rec-quote-box { margin-top: 15px; font-size: 0.9em; color: #555; line-height: 1.6; background: #f4f9ff; border-radius: 12px; padding: 15px; border-left: 4px solid #007aff; }\n    .style-recommendation .info-grid { display: grid; grid-template-columns: 1.5fr 1fr 1fr; gap: 10px; }\n    .style-recommendation .info-unit label { display: block; font-size: 0.65em; color: #9eaab5; margin-bottom: 4px; font-weight: 700; }\n    .style-recommendation .info-unit span { display: block; font-size: 1.05em; font-weight: 700; color: #222; font-family: 'JetBrains Mono', monospace; }\n    .style-recommendation .stub-content { position: relative; z-index: 3; flex: 1; display: flex; flex-direction: column; justify-content: flex-start; }\n    .style-recommendation .stub-dest-group { margin-bottom: 20px; }\n    .style-recommendation .dest-code { font-size: 2.2em; font-weight: 900; letter-spacing: -1px; line-height: 1; text-shadow: 0 2px 10px rgba(0,0,0,0.15); }\n    .style-recommendation .stub-label { font-size: 0.65em; opacity: 0.85; font-weight: 700; margin-bottom: 2px; }\n    .style-recommendation .stub-meta { display: flex; flex-direction: column; gap: 10px; font-family: 'JetBrains Mono', monospace; }\n    .style-recommendation .stub-val { font-size: 1.1em; font-weight: 700; }\n    .style-recommendation .barcode-container { position: relative; z-index: 3; background: rgba(255, 255, 255, 0.922); border-radius: 6px; padding: 5px; display: flex; align-items: center; justify-content: center; margin-top: auto; }\n    .style-recommendation .barcode-font { font-family: 'Libre Barcode 128', cursive; font-size: 2.5em; line-height: 0.8; color: #000; white-space: nowrap; padding-top: 10px; }\n\n    @media (max-width: 480px) {\n        .style-recommendation .card-content-wrapper { flex-direction: column; }\n        .style-recommendation .ticket-main { border-radius: var(--card-radius) var(--card-radius) 0 0; padding: 25px; }\n        .style-recommendation .perforation-line { top: auto; bottom: 0; left: 15px; right: 15px; width: auto; height: 0; border-right: none; border-bottom: 2px dashed #e0e0e0; }\n        .style-recommendation .ticket-stub { flex: 0 0 auto; width: auto; border-radius: 0 0 var(--card-radius) var(--card-radius); padding: 18px 25px; flex-direction: row; align-items: center; justify-content: space-between; gap: 15px; }\n        .style-recommendation .stub-content { flex: 0 1 auto; flex-direction: row; align-items: center; gap: 15px; }\n        .style-recommendation .stub-dest-group { margin-bottom: 0; text-align: left; }\n        .style-recommendation .dest-code { font-size: 1.8em; }\n        .style-recommendation .stub-meta { display: none; }\n        .style-recommendation .barcode-container { margin-top: 0; flex-shrink: 0; padding: 4px 8px; max-width: 100%; overflow: hidden; }\n        .style-recommendation .barcode-font { font-size: 2em; }\n    }\n\n\n    /* =================================================================== */\n    /* --- 模式五：复古磁带 --- */\n    /* =================================================================== */\n\n    .style-memory .card-content-wrapper {\n        position: relative;\n        width: 100%;      \n        max-width: 450px; \n        background-color: #222;\n        border-radius: 16px;\n        overflow: hidden;\n        display: flex; \n        flex-direction: column; \n        padding: 25px;\n        box-sizing: border-box; \n        color: #e0e0e0;\n        font-family: 'Space Mono', monospace;\n        background-image: url(\"data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='1.5' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.08'/%3E%3C/svg%3E\");\n        border: 1px solid #000;\n        box-shadow: \n            0 6px 10px -10px rgba(0,0,0,0.8),\n            inset 0 1px 0 rgba(255,255,255,0.15),\n            inset 0 -1px 0 rgba(0,0,0,0.5);\n    }\n\n    .style-memory .cassette-shell {\n        background: linear-gradient(135deg, #f2ece1 0%, #e6e1d3 40%, #dcd6c5 100%);\n        border-radius: 6px;\n        padding: 12px;\n        width: 100%; \n        box-sizing: border-box; \n        position: relative;\n        margin-bottom: 25px;\n        display: flex; flex-direction: column; align-items: center;\n        box-shadow: \n            0 5px 10px rgba(0,0,0,0.5), 0 2px 3px rgba(0,0,0,0.3),\n            inset 2px 2px 0 rgba(255,255,255,0.8),\n            inset -2px -2px 0 rgba(0,0,0,0.15);\n        border: 1px solid #aaa;\n    }\n\n    .style-memory .screw { position: absolute; width: 8px; height: 8px; background: #bbb; border-radius: 50%; box-shadow: inset 1px 1px 2px rgba(0,0,0,0.8), 0 1px 0 rgba(255,255,255,0.5); }\n    .style-memory .screw::after { content: ''; position: absolute; top: 50%; left: 50%; width: 100%; height: 1px; background: #555; transform: translate(-50%, -50%) rotate(45deg); }\n    .style-memory .screw.tl { top: 6px; left: 6px; } .style-memory .screw.tr { top: 6px; right: 6px; }\n    .style-memory .screw.bl { bottom: 6px; left: 6px; } .style-memory .screw.br { bottom: 6px; right: 6px; }\n\n    .style-memory .tape-label {\n        width: 100%; background: #fff; border-radius: 2px;\n        padding: 8px 5px; margin-bottom: 10px; text-align: center;\n        border-top: 6px solid #ff9900;\n        box-shadow: 0 1px 2px rgba(0,0,0,0.15);\n        transform: rotate(-0.5deg);\n        box-sizing: border-box;\n    }\n    .style-memory .handwritten-title {\n        font-family: 'Caveat', cursive; color: #222; font-size: 1.4em; font-weight: 700; line-height: 1.1;\n        white-space: nowrap; overflow: hidden; text-overflow: ellipsis;\n        max-width: 100%;\n    }\n\n    .style-memory .tape-window {\n        width: 60%;\n        max-width: 220px; \n        min-width: 140px;\n        height: 45px;\n        background: #2a2a2a; border-radius: 30px;\n        position: relative; \n        display: flex; justify-content: space-between; \n        align-items: center; \n        padding: 0 15px; \n        box-sizing: border-box;\n        border: 1px solid #888; overflow: hidden;\n        box-shadow: inset 0 3px 8px rgba(0,0,0,0.7), 0 1px 0 rgba(255,255,255,0.6);\n    }\n    .style-memory .tape-window::before {\n        content: ''; position: absolute; width: 100%; height: 100%; left: 0; top: 0;\n        background: repeating-linear-gradient(90deg, transparent 0, transparent 2px, rgba(255,255,255,0.05) 2px, rgba(255,255,255,0.05) 4px);\n    }\n    \n    .style-memory .reel {\n        width: 32px; height: 32px; \n        flex-shrink: 0; \n        background: #fff; border-radius: 50%; position: relative; z-index: 1; \n        border: 4px solid #fff;\n        background-image: radial-gradient(circle at center, #333 30%, transparent 31%), conic-gradient(from 0deg, #333 0deg 60deg, transparent 60deg 120deg, #333 120deg 180deg, transparent 180deg 240deg, #333 240deg 300deg, transparent 300deg 360deg);\n        animation: spinReel 4s linear infinite;\n        box-shadow: 0 1px 2px rgba(0,0,0,0.3); \n    }\n    .style-memory .reel.left { box-shadow: 0 0 0 3px #5e4b35; } \n    .style-memory .reel.right { box-shadow: 0 0 0 1px #5e4b35; animation-delay: -2s; }\n\n    .style-memory .lcd-panel {\n        background: #9cad8e; border-radius: 4px; padding: 12px 15px;\n        width: 100%; box-sizing: border-box; \n        border: 4px solid #1a1a1a;\n        box-shadow: inset 2px 2px 5px rgba(0,0,0,0.4), 0 1px 0 rgba(255,255,255,0.1);\n        font-family: 'Space Mono', monospace; color: #111;\n        position: relative; display: flex; flex-direction: column; gap: 10px;\n    }\n    .style-memory .lcd-panel::after {\n        content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;\n        background: linear-gradient(rgba(0,0,0,0.03) 50%, transparent 50%); background-size: 100% 4px; pointer-events: none;\n    }\n\n    .style-memory .meta-row { display: flex; justify-content: space-between; align-items: center; font-size: 0.7em; font-weight: 700; opacity: 0.8; border-bottom: 1px dotted #111; padding-bottom: 4px; }\n    \n    .style-memory .scrolling-text {\n        font-size: 0.95em; line-height: 1.5; height: 90px; overflow-y: auto; white-space: pre-wrap;\n        text-align: left; padding-right: 5px; margin: 0;\n    }\n    .style-memory .scrolling-text::-webkit-scrollbar { width: 3px; }\n    .style-memory .scrolling-text::-webkit-scrollbar-thumb { background: #1a1a1a; }\n\n    .style-memory .thought-line {\n        font-size: 0.8em; color: #444; background: rgba(0,0,0,0.05); padding: 6px 8px; border-radius: 2px;\n        font-style: italic; border-left: 3px solid #ff4444; margin-top: 2px;\n    }\n    .style-memory .thought-label { font-weight: bold; text-transform: uppercase; font-size: 0.8em; opacity: 0.7; margin-right: 5px; }\n\n    .style-memory .visualizer-row { display: flex; justify-content: space-between; align-items: flex-end; margin-top: 5px; padding-top: 5px; border-top: 1px dotted #111; }\n    .style-memory .play-status { font-size: 0.7em; font-weight: bold; display: flex; align-items: center; gap: 5px; }\n    .style-memory .led { width: 6px; height: 6px; background: #ff3333; border-radius: 50%; box-shadow: 0 0 5px #ff3333; animation: blinkLed 1.5s infinite; }\n    .style-memory .visualizer { display: flex; align-items: flex-end; gap: 2px; height: 12px; }\n    .style-memory .bar { width: 3px; background: #111; animation: equalizer 0.8s infinite ease-in-out; }\n    .style-memory .bar:nth-child(1) { animation-duration: 0.6s; height: 40%; }\n    .style-memory .bar:nth-child(2) { animation-duration: 1.0s; height: 80%; }\n    .style-memory .bar:nth-child(3) { animation-duration: 0.7s; height: 50%; }\n    .style-memory .bar:nth-child(4) { animation-duration: 0.9s; height: 90%; }\n    .style-memory .bar:nth-child(5) { animation-duration: 1.1s; height: 30%; }\n\n    .style-memory .controls-deco { \n        display: flex; \n        justify-content: space-between; \n        width: 100%; \n        gap: 2%;\n        margin-top: 20px; \n    }\n    .style-memory .btn-deco { \n        flex: 1;\n        max-width: 50px; \n        height: 12px; \n        background: #3a3a3a; border-radius: 2px; \n        box-shadow: 0 3px 0 #111, 0 4px 5px rgba(0,0,0,0.5); \n    }\n    .style-memory .btn-deco.active { background: #555; transform: translateY(3px); box-shadow: 0 0 0 #111, inset 0 1px 3px rgba(0,0,0,0.5); border-bottom: 2px solid #ff9900; }\n\n    @keyframes spinReel { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }\n    @keyframes equalizer { 0%, 100% { height: 20%; } 50% { height: 100%; } }\n    @keyframes blinkLed { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }\n\n    @media (max-width: 480px) {\n        .style-memory .card-content-wrapper {\n            max-width: 320px;\n            padding: 15px; \n        }\n\n        .style-memory .tape-window {\n            height: 40px; \n            padding: 0 10px;\n        }\n        .style-memory .reel {\n            width: 26px; height: 26px;\n            border-width: 3px; \n        }\n\n        .style-memory .scrolling-text {\n            font-size: 0.85em; \n        }\n        \n        .style-memory .controls-deco {\n            margin-top: 15px;\n        }\n\n        .style-memory .handwritten-title {\n            font-size: 1em;\n        }\n    }\n\n    /* =================================================================== */\n    /* 4. 模式二：艺术明信片 */\n    /* =================================================================== */\n    .reverie-container.style-postcard {\n        width: 420px;\n        height: 480px;\n        perspective: 1500px;\n        background: transparent;\n    }\n\n    .card-flipper {\n        position: relative;\n        width: 100%;\n        height: 100%;\n        transform-style: preserve-3d;\n        transition: transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);\n        cursor: pointer;\n    }\n\n    .style-postcard.is-flipped .card-flipper {\n        transform: rotateY(180deg);\n    }\n\n    .style-postcard .card-face {\n        position: absolute;\n        top: 0; left: 0;\n        width: 100%; height: 100%;\n        backface-visibility: hidden;\n        -webkit-backface-visibility: hidden;\n        border-radius: 4px;\n        overflow: hidden;\n        background-color: #fff;\n        box-shadow: 0 10px 30px rgba(0,0,0,0.15), 0 1px 3px rgba(0,0,0,0.1);\n    }\n\n    /* 正面样式 */\n    .style-postcard .card-front {\n        z-index: 2;\n        display: flex; flex-direction: column;\n        padding: 12px 12px 50px 12px;\n        transform: rotateY(0deg);\n    }\n    .style-postcard .photo-area {\n        flex: 1;\n        background-color: #1a1a1a;\n        position: relative;\n        overflow: hidden;\n        display: flex; justify-content: center; align-items: center;\n        padding: 30px; text-align: center;\n    }\n    .style-postcard .grain-overlay {\n        position: absolute; top: 0; left: 0; width: 100%; height: 100%;\n        background-image: url(\"data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='1.2' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.1'/%3E%3C/svg%3E\");\n        pointer-events: none; opacity: 0.5;\n    }\n    .style-postcard .poster-text {\n        position: relative; z-index: 2;\n        color: rgba(255, 255, 255, 0.9);\n        font-family: 'Cinzel', serif; font-size: 1.1em; line-height: 1.6;\n        text-shadow: 0 0 10px rgba(255,255,255,0.3);\n    }\n    .style-postcard .poster-quote-mark {\n        display: block; font-size: 2em; line-height: 0.5;\n        color: rgba(255,255,255,0.3); margin-bottom: 20px;\n    }\n    .style-postcard .front-caption {\n        height: 50px;\n        display: flex; justify-content: center; align-items: center;\n        font-family: 'JetBrains Mono', monospace; font-size: 0.85em;\n        color: #666; letter-spacing: 1px; text-transform: uppercase;\n        margin-top: 5px;\n    }\n\n    /* 背面样式 */\n    .style-postcard .card-back {\n        transform: rotateY(180deg);\n        background-color: #f4f1ea;\n        background-image: radial-gradient(#d0c8b0 1px, transparent 1px);\n        background-size: 20px 20px;\n        padding: 30px 25px 40px 25px;\n        display: flex; flex-direction: column; align-items: center;\n    }\n    .style-postcard .stamp-box {\n        align-self: flex-end; width: 60px; height: 70px; background: #fff;\n        border: 1px solid #ddd; padding: 4px; box-shadow: 1px 1px 3px rgba(0,0,0,0.1);\n        background-image: radial-gradient(transparent 50%, #f4f1ea 50%);\n        background-size: 10px 10px; background-position: -5px -5px;\n        display: flex; justify-content: center; align-items: center; margin-bottom: 10px;\n    }\n    .style-postcard .stamp-inner {\n        width: 100%; height: 100%; background: #2c3e50; color: #fff;\n        display: flex; justify-content: center; align-items: center;\n        font-size: 0.6em; font-family: 'Cinzel', serif;\n    }\n    .style-postcard .postmark-circle {\n        position: absolute; top: 30px; right: 75px;\n        width: 60px; height: 60px; border: 2px solid rgba(50,50,50,0.3);\n        border-radius: 50%; color: rgba(50,50,50,0.3);\n        display: flex; justify-content: center; align-items: center; text-align: center;\n        font-family: monospace; font-size: 0.6em; line-height: 1;\n        transform: rotate(-15deg); mix-blend-mode: multiply; pointer-events: none;\n    }\n    .style-postcard .writing-lines {\n        flex: 1; \n        width: 100%; \n        margin: 20px 0 10px 0;\n        background-image: linear-gradient(to bottom, transparent 29px, #a3b8cc 30px);\n        background-size: 100% 30px; \n        display: flex;\n        flex-direction: column;\n        justify-content: flex-start; \n        align-items: center;      \n        overflow: hidden;         \n    }\n\n    .style-postcard .sender-signature {\n        font-family: 'Dancing Script', cursive;\n        font-size: 1.1em; \n        color: #2c3e50;\n        line-height: 30px; \n        width: 88%;      \n        text-align: left; \n        white-space: pre-wrap; \n        margin-top: 5px;   \n        opacity: 0.9;\n    }\n    .style-postcard .sender-signature {\n        font-family: 'Dancing Script', cursive; font-size: 1.2em;\n        color: #2c3e50; transform: none; line-height: 30px;\n        margin-bottom: 2px; opacity: 0.8;\n    }\n    .style-postcard .air-mail-strip {\n        position: absolute; bottom: 0; left: 0; width: 100%; height: 8px;\n        background: repeating-linear-gradient(45deg, #e74c3c, #e74c3c 10px, #fff 10px, #fff 20px, #3498db 20px, #3498db 30px, #fff 30px, #fff 40px);\n    }\n\n\n    /* =================================================================== */\n    /* --- 模式四：神圣拱门 (Fortune - Final Version) --- */\n    /* =================================================================== */\n\n    .style-fortune .card-content-wrapper {\n        position: relative;\n        width: 100%;\n        max-width: 320px;\n        background: transparent;\n        filter: drop-shadow(0 0 3px rgba(255, 215, 0, 0.25)) drop-shadow(0 6px 10px rgba(0,0,0,0.2));\n        display: flex; justify-content: center; align-items: center;\n        animation: hoverFloat 6s ease-in-out infinite;\n        padding-top: 10px;\n    }\n\n    .style-fortune .arch-frame {\n        position: relative; width: 100%; min-height: 200px; \n        border-radius: 160px 160px 12px 12px;\n        background: radial-gradient(circle at 50% 30%, #203a6e, #101b3b 60%, #080c18 100%);\n        overflow: hidden;\n        border: 4px solid #b8860b;\n        box-shadow: inset 0 0 0 3px #080c18, inset 0 0 0 5px #ffd700;\n    }\n\n    .style-fortune .arch-frame::after {\n        content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;\n        border-radius: 160px 160px 12px 12px;\n        border: 4px solid rgba(255, 215, 0, 0.4);\n        mask-image: linear-gradient(45deg, transparent 40%, black 50%, transparent 60%);\n        -webkit-mask-image: linear-gradient(45deg, transparent 40%, black 50%, transparent 60%);\n        mask-size: 200%; -webkit-mask-size: 200%;\n        animation: shineBorder 4s infinite linear; pointer-events: none; z-index: 5;\n    }\n\n    .style-fortune .stars-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; }\n    .style-fortune .zodiac-ring {\n        position: absolute; top: 35%; left: 50%; width: 400px; height: 400px;\n        background-image: url(\"data:image/svg+xml,%3Csvg viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='50' cy='50' r='49' fill='none' stroke='rgba(255,215,0,0.08)' stroke-width='0.5' stroke-dasharray='2'/%3E%3Ccircle cx='50' cy='50' r='35' fill='none' stroke='rgba(255,215,0,0.05)' stroke-width='2'/%3E%3Cpath d='M50 0 L50 100 M0 50 L100 50' stroke='rgba(255,215,0,0.05)' stroke-width='0.5'/%3E%3C/svg%3E\");\n        transform: translate(-50%, -50%);\n        animation: rotateZodiac 120s linear infinite;\n    }\n    .style-fortune .stardust {\n        position: absolute; background: #fff; border-radius: 50%;\n        box-shadow: 0 0 4px #fff, 0 0 8px rgba(255, 215, 0, 0.5);\n        opacity: 0; animation: twinkle 3s infinite ease-in-out;\n    }\n\n    .style-fortune .content-layout {\n        position: relative; z-index: 2;\n        display: flex; flex-direction: column; align-items: center; text-align: center;\n        padding: 60px 30px 40px 30px; height: 100%; color: #e0d2b4;\n    }\n\n    .style-fortune .top-icon {\n        font-size: 2em; color: #ffd700; margin-bottom: 20px; opacity: 0.9;\n        filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.6));\n    }\n    \n    .style-fortune .arch-num {\n        font-family: 'Cinzel', serif; font-size: 0.9em; letter-spacing: 2px; color: #8a9bbd; margin-bottom: 5px;\n    }\n    \n    .style-fortune .arch-title {\n        font-family: 'Cinzel', serif; font-size: 1.6em; font-weight: 700; line-height: 1.2; text-transform: uppercase; margin-bottom: 25px;\n        background: linear-gradient(to bottom, #fff, #ffd700); -webkit-background-clip: text; -webkit-text-fill-color: transparent;\n        filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5));\n    }\n\n    .style-fortune .arch-text-area {\n        margin-top: auto; width: 100%;\n        background: rgba(0, 0, 0, 0.4);\n        border-top: 1px solid rgba(255, 215, 0, 0.3);\n        padding: 20px 15px; border-radius: 8px;\n        backdrop-filter: blur(4px);\n        display: flex; flex-direction: column; gap: 12px;\n    }\n\n    .style-fortune .keywords {\n        font-size: 0.8em; color: #81cdf8; letter-spacing: 1px; text-transform: uppercase; font-weight: 700;\n    }\n\n    .style-fortune .description {\n        font-family: 'Noto Serif SC', serif; font-size: 0.95em; line-height: 1.6; color: #dce5f2;\n        text-align: justify;\n    }\n\n    /* 新增：角色评论样式 */\n    .style-fortune .char-comment {\n        font-family: 'Noto Serif SC', serif;\n        font-size: 0.85em;\n        line-height: 1.5;\n        color: #e6c288; \n        border-top: 1px dashed rgba(255, 215, 0, 0.3); \n        padding-top: 10px;\n        margin-top: 5px;\n        font-style: italic;\n        opacity: 0.9;\n        text-align: left;\n    }\n\n    @keyframes hoverFloat { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }\n    @keyframes rotateZodiac { from { transform: translate(-50%, -50%) rotate(0deg); } to { transform: translate(-50%, -50%) rotate(360deg); } }\n    @keyframes shineBorder { 0% { -webkit-mask-position: 200%; } 100% { -webkit-mask-position: -200%; } }\n    @keyframes twinkle { 0%, 100% { opacity: 0; transform: scale(0.2); } 50% { opacity: 1; transform: scale(1.2); } }\n</style>\n</head>\n<body>\n\n<div class=\"reverie-container\" id=\"reverieCard\"></div>\n\n<div id=\"raw-data\" style=\"display: none;\">\n$1\n</div>\n\n<script>\n    document.addEventListener('DOMContentLoaded', () => {\n        // --- 1. 数据获取与预处理 ---\n        const cardContainer = document.getElementById('reverieCard');\n        const rawData = document.getElementById('raw-data');\n        if (!cardContainer || !rawData) return;\n\n        const rawText = rawData.textContent.trim();\n        \n        const activeModeMatch = rawText.match(/^(?:模式[:：])?(.*)\\n([\\s\\S]*)$/);\n        \n        let mode = 'excerpt'; \n        let content = rawText;\n\n        if (activeModeMatch) {\n            mode = activeModeMatch[1].trim(); \n            content = activeModeMatch[2];\n        } else {\n            content = rawText.trim();\n        }\n\n        const cleanSymbols = (str) => {\n            if (!str) return '';\n            // 链式调用：先去Markdown符号，再去括号\n            return str.replace(/\\*\\*|__|\\*|_|~~/g, '').replace(/[()（）]/g, '').trim();\n        };\n\n        const lines = content.split('\\n').map(l => l.trim()).filter(Boolean).map(cleanSymbols);\n\n        // --- 2. 容器初始化 ---\n        cardContainer.innerHTML = '';\n        cardContainer.className = 'reverie-container';\n        cardContainer.classList.add(`style-${mode}`, 'active');\n\n        // --- 3. 模式构建逻辑 ---\n\n         if (mode === 'postcard') {\n          \n            const photoText = lines[0] || '...';\n            \n            const caption = lines[1] || 'UNTITLED MEMORY';\n            \n            const senderMessage = lines.slice(2).join('<br>') || 'Anonymous';\n            \n            const dateStr = new Date().toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: '2-digit' }).toUpperCase();\n\n            const flipper = document.createElement('div');\n            flipper.className = 'card-flipper';\n            \n            flipper.innerHTML = `\n                <div class=\"card-face card-front\">\n                    <div class=\"photo-area\">\n                        <div class=\"grain-overlay\"></div>\n                        <div class=\"poster-text\">\n                            <span class=\"poster-quote-mark\">“</span>\n                            ${photoText}\n                        </div>\n                    </div>\n                    <div class=\"front-caption\">\n                        ${caption}\n                    </div>\n                </div>\n\n                <div class=\"card-face card-back\">\n                    <div class=\"stamp-box\">\n                        <div class=\"stamp-inner\">ECHO</div>\n                    </div>\n                    <div class=\"postmark-circle\">\n                        SENT<br>${dateStr}\n                    </div>\n\n                    <div class=\"writing-lines\">\n                        <div class=\"sender-signature\">${senderMessage}</div>\n                    </div>\n\n                    <div class=\"air-mail-strip\"></div>\n                </div>\n            `;\n            \n            cardContainer.appendChild(flipper);\n            cardContainer.addEventListener('click', () => {\n                cardContainer.classList.toggle('is-flipped');\n            });\n\n        } else if (mode === 'recommendation') {\n            const wrapper = document.createElement('div');\n            wrapper.className = 'card-content-wrapper';\n            \n            const flightCode = 'RV-' + Math.floor(100 + Math.random() * 899);\n            const gate = 'G' + Math.ceil(Math.random() * 20);\n            const seat = Math.ceil(Math.random() * 30) + ['A','B','C','D'][Math.floor(Math.random()*4)];\n            const time = new Date().toLocaleTimeString('en-GB', {hour: '2-digit', minute:'2-digit'});\n            \n            const sharer = lines[0] || 'Traveler';\n            let title = lines[1] || 'Untitled';\n            let artist = '';\n            \n            const separators = [' by ', ' - ', '——', ' / '];\n            for (const sep of separators) {\n                if (title.includes(sep)) {\n                    const parts = title.split(sep);\n                    title = parts[0].trim();\n                    artist = parts[1].trim();\n                    break;\n                }\n            }\n            const comment = lines[2] || 'Ready for takeoff.';\n\n            wrapper.innerHTML = `\n                <div class=\"ticket-main\">\n                    <div class=\"texture-overlay\"></div>\n                    <div class=\"perforation-line\"></div>\n                    <div class=\"ticket-header\">\n                        <div class=\"airline-brand\"><i class=\"fa-solid fa-plane-up\"></i><span>REVERIE AIR</span></div>\n                        <span class=\"priority-tag\">PRIORITY</span>\n                    </div>\n                    <div class=\"content-body\">\n                        <div class=\"rec-label\">BOARDING PASS</div>\n                        <div class=\"rec-title\">${title}</div>\n                        ${artist ? `<div class=\"rec-artist\">${artist}</div>` : ''}\n                        <div class=\"rec-quote-box\">\"${comment}\"</div>\n                    </div>\n                    <div class=\"info-grid\">\n                        <div class=\"info-unit\"><label>PASSENGER</label><span>${sharer}</span></div>\n                        <div class=\"info-unit\"><label>FLIGHT</label><span>${flightCode}</span></div>\n                        <div class=\"info-unit\"><label>TIME</label><span>${time}</span></div>\n                    </div>\n                </div>\n                <div class=\"ticket-stub\">\n                    <div class=\"texture-overlay\"></div>\n                    <div class=\"stub-content\">\n                        <div class=\"stub-dest-group\"><div class=\"stub-label\">DEST</div><div class=\"dest-code\">SOUL</div></div>\n                        <div class=\"stub-meta\">\n                            <div><div class=\"stub-label\">SEAT</div><div class=\"stub-val\">${seat}</div></div>\n                            <div><div class=\"stub-label\">GATE</div><div class=\"stub-val\">${gate}</div></div>\n                        </div>\n                    </div>\n                    <div class=\"barcode-container\"><div class=\"barcode-font\">${flightCode}</div></div>\n                </div>\n            `;\n            cardContainer.appendChild(wrapper);\n\n        } else if (mode === 'memory') {\n            const wrapper = document.createElement('div');\n            wrapper.className = 'card-content-wrapper';\n            \n            document.body.style.backgroundColor = 'transparent';\n            \n            const tapeLabel = lines[0] || 'Unlabeled Tape';\n            const memoryText = lines[1] || '...';\n            const currentThought = lines[2] || 'End of tape.';\n            \n            const min = Math.floor(Math.random() * 5);\n            const sec = Math.floor(Math.random() * 60).toString().padStart(2, '0');\n            const timeStr = `0${min}:${sec}`;\n\n            wrapper.innerHTML = `\n                <div class=\"cassette-shell\">\n                    <div class=\"screw tl\"></div><div class=\"screw tr\"></div>\n                    <div class=\"screw bl\"></div><div class=\"screw br\"></div>\n                    \n                    <div class=\"tape-label\">\n                        <div class=\"handwritten-title\">${tapeLabel}</div>\n                    </div>\n                    \n                    <div class=\"tape-window\">\n                        <div class=\"reel left\"></div>\n                        <div class=\"reel right\"></div>\n                    </div>\n                </div>\n\n                <div class=\"lcd-panel\">\n                    <div class=\"meta-row\">\n                        <span>PLAYING ►</span>\n                        <span>${timeStr}</span>\n                    </div>\n                    \n                    <div class=\"scrolling-text\">${memoryText}</div>\n\n                    <div class=\"thought-line\">\n                        <span class=\"thought-label\">NOTE:</span> ${currentThought}\n                    </div>\n\n                    <div class=\"visualizer-row\">\n                        <div class=\"play-status\">\n                            <span class=\"led\"></span> REC\n                        </div>\n                        <div class=\"visualizer\">\n                            <div class=\"bar\"></div><div class=\"bar\"></div>\n                            <div class=\"bar\"></div><div class=\"bar\"></div><div class=\"bar\"></div>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class=\"controls-deco\">\n                    <div class=\"btn-deco\"></div>\n                    <div class=\"btn-deco\"></div>\n                    <div class=\"btn-deco active\"></div>\n                    <div class=\"btn-deco\"></div>\n                </div>\n            `;\n            cardContainer.appendChild(wrapper);\n\n        } else if (mode === 'fortune') {\n            // ==========================================\n            // 模式四：神圣拱门 (Fortune - 4 Lines Support)\n            // ==========================================\n            const wrapper = document.createElement('div');\n            wrapper.className = 'card-content-wrapper';\n\n            document.body.style.backgroundColor = 'transparent';\n\n            // --- 数据解析 ---\n            // Line 1: 牌名/状态 (e.g., 圣杯侍从 - 正位)\n            // Line 2: 关键词\n            // Line 3: 解读\n            // Line 4: 角色评论 (需去除 *)\n\n            let cardNum = 'ARCANA';\n            let cardName = 'DESTINY';\n            \n            const firstLine = lines[0] || '';\n            if (firstLine.includes('-')) {\n                const parts = firstLine.split('-');\n                cardNum = parts[0].trim();\n                cardName = parts[1].trim();\n            } else {\n                cardName = firstLine;\n            }\n\n            const keywords = lines[1] || 'Unknown';\n            const description = lines[2] || 'The stars are silent.';\n            \n            // 处理第四行：角色评论\n            let charComment = '';\n            if (lines[3]) {\n                // 自动消除 * 号，并去除首尾空格\n                charComment = lines[3].replace(/\\*/g, '').trim();\n            }\n\n            // 随机图标\n            const mysticIcons = [\n                'fa-regular fa-sun', 'fa-regular fa-moon', 'fa-regular fa-star',\n                'fa-solid fa-eye', 'fa-solid fa-infinity', 'fa-solid fa-meteor',\n                'fa-solid fa-hand-sparkles'\n            ];\n            const randomIconClass = mysticIcons[Math.floor(Math.random() * mysticIcons.length)];\n\n            // 随机星尘\n            let starsHtml = '';\n            for(let i=0; i<25; i++) {\n                const top = Math.random() * 100;\n                const left = Math.random() * 100;\n                const size = 1 + Math.random() * 2;\n                const delay = Math.random() * 3;\n                starsHtml += `<div class=\"stardust\" style=\"top:${top}%; left:${left}%; width:${size}px; height:${size}px; animation-delay:${delay}s\"></div>`;\n            }\n\n            wrapper.innerHTML = `\n                <div class=\"arch-frame\">\n                    <div class=\"stars-bg\">\n                        <div class=\"zodiac-ring\"></div>\n                        ${starsHtml}\n                    </div>\n\n                    <div class=\"content-layout\">\n                        <div class=\"top-icon\">\n                            <i class=\"${randomIconClass}\"></i>\n                        </div>\n\n                        <div class=\"arch-num\">${cardNum}</div>\n                        <div class=\"arch-title\">${cardName}</div>\n\n                        <div class=\"arch-text-area\">\n                            <div class=\"keywords\">✦ ${keywords} ✦</div>\n                            <div class=\"description\">${description}</div>\n                            \n                            ${charComment ? `<div class=\"char-comment\">${charComment}</div>` : ''}\n                        </div>\n                    </div>\n                </div>\n            `;\n            cardContainer.appendChild(wrapper);\n\n        } else {\n            const wrapper = document.createElement('div');\n            wrapper.className = 'card-content-wrapper';\n            \n            const now = new Date();\n            const dateTimeStr = `${now.getFullYear().toString().slice(-2)}.${String(now.getMonth()+1).padStart(2,'0')}.${String(now.getDate()).padStart(2,'0')} ${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;\n            const orderNo = Math.floor(1000 + Math.random() * 9000);\n\n            const mainText = lines[0] || 'Unknown Item';\n            const sourceText = lines[1] || '';\n            const noteText = lines[2] || '';\n\n            wrapper.innerHTML = `\n                <div class=\"receipt-header\">\n                    <h1 class=\"brand-logo\">E C H O</h1>\n                    <div class=\"store-info\">MEM_FRAGMENT_STORE_01</div>\n                </div>\n                <div class=\"meta-line\"><span>NO.${orderNo}</span><span>${dateTimeStr}</span></div>\n                <div class=\"item-section\">\n                    <div class=\"item-row\">\n                        <span class=\"qty\">1</span>\n                        <div class=\"desc\">\n                            <span class=\"main-content\">${mainText}</span>\n                            ${sourceText ? `<div class=\"sub-content\">${sourceText}</div>` : ''}\n                            ${noteText ? `<div class=\"simple-note\">${noteText}</div>` : ''}\n                        </div>\n                        <span class=\"price\">∞</span>\n                    </div>\n                </div>\n                <div class=\"total-section\">\n                    <div class=\"total-row\"><span>TOTAL</span><span>PRICELESS</span></div>\n                    <div class=\"card-info\">PAID WITH SOUL ****8888</div>\n                </div>\n                <div class=\"receipt-footer\">\n                    <div class=\"barcode-font\">${orderNo}ECHO</div>\n                    <div style=\"font-size:0.7em; letter-spacing:1px;\">THANK YOU FOR VISITING</div>\n                </div>\n            `;\n            cardContainer.appendChild(wrapper);\n        }\n    });\n</script>\n</body>\n</html>\n```",
        "trimStrings": [],
        "placement": [
            2
        ],
        "disabled": false,
        "markdownOnly": true,
        "promptOnly": false,
        "runOnEdit": true,
        "substituteRegex": 0,
        "minDepth": null,
        "maxDepth": 10
    },
    {
        "id": "57bb01cb-6cae-45f7-811e-425e3a96644f",
        "scriptName": "象牙塔美化-心绪回响|古风（0106） @电波系",
        "findRegex": "/<echo>\\s+([\\s\\S]*?)</echo>/gi",
        "replaceString": "```html\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n<meta charset=\"UTF-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<title>心绪回响 · 浮生卷</title>\n\n<!-- 引入古风书法字体 -->\n<link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n<link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n<link href=\"https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@300;600;900&family=Zhi+Mang+Xing&family=Long+Cang&display=swap\" rel=\"stylesheet\">\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\n\n<style>\n    @import url('https://static.zeoseven.com/zsft/256/main/result.css');\n    @import url(\"https://fontsapi.zeoseven.com/2/main/result.css\");\n    @import url(\"https://fontsapi-storage.zeoseven.com/111/main/result.css\");\n    @import url(\"https://fontsapi.zeoseven.com/874/main/result.css\");\n\n    :root {\n        --ink-color: #2c2c2c;\n        --paper-bg: #f4ecd8;\n        --red-seal: #b5382e;\n        --jade-green: #5c8d89;\n        --gold-accent: #c5a059;\n        --font-serif: 'LXGW ZhenKai GB';\n        --font-calligraphy: 'Zhi Mang Xing', cursive;\n        --font-title: 'Huiwen-Mincho';\n        --font-hand: 'ChillHuoKai';\n    }\n\n    body { \n        display: flex; \n        justify-content: center; \n        align-items: center; \n        margin: 0; \n        padding: 10px; \n        box-sizing: border-box; \n        font-family: var(--font-serif);\n    }\n\n    .reverie-container {\n        max-width: 600px;\n        margin: 0 auto;\n        display: none; \n        animation: fadeIn 1s ease-out;\n    }\n    .reverie-container.active { display: block; }\n\n    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }\n\n    /* =================================================================== */\n    /* 1. 模式一：古籍残卷 (Excerpt) */\n    /* =================================================================== */\n    .style-excerpt .card-content-wrapper {\n        position: relative;\n        background: var(--paper-bg);\n        width: 100%;\n        max-width: 380px;\n        margin: 0 auto;\n        padding: 40px 30px;\n        box-shadow: 0 6px 8px rgba(0,0,0,0.15), inset 0 0 60px rgba(139, 69, 19, 0.1);\n        color: var(--ink-color);\n        writing-mode: horizontal-tb; /* 网页阅读习惯保留横排，但设计感做竖排意向 */\n        border-right: 4px solid #dcdcdc; /* 模拟书卷厚度 */\n        overflow: hidden;\n    }\n\n    /* 纸张纹理 */\n    .style-excerpt .card-content-wrapper::before {\n        content: \"\"; position: absolute; top: 0; left: 0; width: 100%; height: 100%;\n        background-image: url(\"data:image/svg+xml,%3Csvg width='200' height='200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='paper'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.04' numOctaves='5'/%3E%3CfeDiffuseLighting lighting-color='%23fff5e6' surfaceScale='2'%3E%3CfeDistantLight azimuth='45' elevation='60'/%3E%3C/feDiffuseLighting%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23paper)' opacity='0.4'/%3E%3C/svg%3E\");\n        pointer-events: none; mix-blend-mode: multiply;\n    }\n    \n    /* 顶部装饰线 */\n    .style-excerpt .receipt-header { \n        border-bottom: 2px solid var(--ink-color); \n        border-top: 2px solid var(--ink-color);\n        padding: 5px 0; margin-bottom: 25px; text-align: center;\n        position: relative; z-index: 2;\n    }\n    .style-excerpt .brand-logo { font-family: var(--font-title); font-size: 1.8em; margin: 0; color: var(--ink-color); letter-spacing: 5px; }\n\n    /* 内容区 */\n    .style-excerpt .item-section { position: relative; z-index: 2; padding: 10px 0; }\n    .style-excerpt .main-content { \n        font-family: var(--font-calligraphy); \n        font-size: 1.8em; \n        line-height: 1.4; \n        display: block; \n        text-align: center;\n        margin-bottom: 15px;\n        text-shadow: 0 0 1px rgba(0,0,0,0.1);\n    }\n    .style-excerpt .sub-content { \n        font-family: var(--font-serif); \n        font-size: 0.9em; \n        color: #555; \n        text-align: right; \n        margin-top: 10px; \n        font-style: italic;\n    }\n\n    /* 眉批 */\n    .style-excerpt .simple-note { \n        margin-top: 25px; \n        font-family: var(--font-hand); \n        font-size: 1.1em; \n        color: var(--red-seal); \n        border-left: 2px solid var(--red-seal);\n        padding-left: 10px;\n        opacity: 0.9;\n        transform: rotate(-1deg);\n    }\n\n    /* 印章 */\n    .style-excerpt .stamp-seal {\n        position: absolute; bottom: 20px; right: 20px;\n        width: 60px; height: 60px;\n        border: 3px solid var(--red-seal);\n        color: var(--red-seal);\n        font-family: var(--font-title);\n        display: flex; justify-content: center; align-items: center;\n        border-radius: 4px;\n        font-size: 24px;\n        opacity: 0.7;\n        transform: rotate(-15deg);\n        mask-image: url(\"data:image/svg+xml,%3Csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='1.5' numOctaves='3'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' fill='black'/%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.5'/%3E%3C/svg%3E\");\n        -webkit-mask-image: url(\"data:image/svg+xml,%3Csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='1.5' numOctaves='3'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' fill='black'/%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.5'/%3E%3C/svg%3E\");\n    }\n\n    /* =================================================================== */\n    /* 3. 模式三：青黛雅帖 (Recommendation - 雅致版) */\n    /* =================================================================== */\n    .style-recommendation .card-content-wrapper {\n        display: flex;\n        flex-direction: column;\n        width: 100%;\n        max-width: 320px; /* 手机竖屏最佳宽度 */\n        min-height: 400px;\n        /* 核心背景：深青灰 + 噪点质感 */\n        background-color: #354a4b; \n        background-image: url(\"data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.05'/%3E%3C/svg%3E\");\n        border-radius: 8px;\n        /* 阴影：柔和的深色投影 */\n        box-shadow: 0 6px 8px rgba(0,0,0,0.3);\n        position: relative;\n        overflow: hidden;\n        color: #e6ebeb;\n        margin: 0 auto;\n        /* 内边框：极细的单线，营造精致感 */\n        border: 1px solid rgba(255, 255, 255, 0.15);\n    }\n\n    /* 装饰元素：顶部的淡色云纹/山纹 */\n    .style-recommendation .card-content-wrapper::before {\n        content: '';\n        position: absolute;\n        top: -50px; left: -50px; width: 200px; height: 200px;\n        background: radial-gradient(circle, rgba(255,255,255,0.05) 0%, transparent 70%);\n        pointer-events: none;\n    }\n\n    /* 1. 顶部：赠礼人 (设计为一枚银质/玉质腰牌) */\n    .style-recommendation .giver-tag-container {\n        display: flex;\n        justify-content: center;\n        padding-top: 30px;\n        margin-bottom: 10px;\n        position: relative;\n        z-index: 2;\n    }\n    \n    .style-recommendation .giver-tag {\n        /* 这里的背景半透明，融合底色 */\n        background: rgba(255, 255, 255, 0.1);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        color: #d1dddd; /* 淡青白文字 */\n        font-family: var(--font-serif);\n        padding: 4px 16px;\n        border-radius: 50px; /* 胶囊形状 */\n        font-size: 0.8em;\n        letter-spacing: 2px;\n        display: flex; align-items: center; gap: 8px;\n        backdrop-filter: blur(4px);\n    }\n    \n    .style-recommendation .giver-tag::before {\n        content: '✦'; \n        color: #aebaba;\n        font-size: 0.8em;\n    }\n\n    /* 2. 中部：宝物展示 (极简，留白) */\n    .style-recommendation .item-display {\n        flex: 1;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n        text-align: center;\n        padding: 10px 30px;\n        position: relative;\n        z-index: 2;\n    }\n\n    /* 竖线装饰，连接上下 */\n    .style-recommendation .item-display::after {\n        content: '';\n        position: absolute;\n        height: 40px; width: 1px;\n        background: linear-gradient(to bottom, transparent, rgba(255,255,255,0.3), transparent);\n        bottom: -20px; left: 50%;\n    }\n\n    .style-recommendation .item-main {\n        font-family: var(--font-title);\n        font-size: 2.2em;\n        line-height: 1.3;\n        margin-bottom: 8px;\n        color: #ffffff;\n        text-shadow: 0 2px 10px rgba(0,0,0,0.2);\n        letter-spacing: 2px;\n    }\n    \n    .style-recommendation .item-origin {\n        font-family: var(--font-serif);\n        font-size: 0.8em;\n        color: #8fa3a3; /* 灰青色 */\n        letter-spacing: 1px;\n        opacity: 0.8;\n    }\n\n    /* 3. 底部：素笺寄语 (设计为一张插在下方的素纸) */\n    .style-recommendation .message-section {\n        background: #f0f5f5; /* 极淡的青白色素纸 */\n        margin: 0;\n        padding: 30px 25px 40px 25px;\n        position: relative;\n        color: #354a4b; /* 深色墨迹 */\n        /* 上方做不规则边缘或简单弧线 */\n        clip-path: polygon(0 20px, 100% 0, 100% 100%, 0% 100%);\n    }\n\n    /* 纸张纹理 */\n    .style-recommendation .message-section::before {\n        content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;\n        background-image: url(\"data:image/svg+xml,%3Csvg width='100' height='100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.5'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.08'/%3E%3C/svg%3E\");\n        pointer-events: none; mix-blend-mode: multiply;\n    }\n\n    .style-recommendation .message-text {\n        font-family: var(--font-hand);\n        font-size: 1.15em;\n        line-height: 1.8;\n        text-align: justify;\n        margin-top: 10px;\n        opacity: 0.9;\n    }\n\n    /* 落款印章 (改为雅致的闲章风格，不用大红) */\n    .style-recommendation .seal-mark {\n        position: absolute;\n        bottom: 15px;\n        right: 20px;\n        width: 24px; height: 24px;\n        border: 1px solid #7a8b8b;\n        color: #7a8b8b; /* 石青色印章，而非朱红 */\n        font-size: 0.6em;\n        display: flex; justify-content: center; align-items: center;\n        border-radius: 2px;\n        opacity: 0.6;\n        font-family: var(--font-serif);\n    }\n\n    /* =================================================================== */\n    /* 5. 模式五：水月镜花 (Memory - 编年史版) */\n    /* =================================================================== */\n    .style-memory .card-content-wrapper {\n        position: relative;\n        width: 100%;\n        max-width: 360px;\n        min-height: 420px;\n        margin: 0 auto;\n        /* 背景：深墨色 + 水波纹理 */\n        background-color: #1a1c20;\n        background-image: \n            radial-gradient(circle at 10% 20%, rgba(255,255,255,0.03) 0%, transparent 20%),\n            radial-gradient(circle at 90% 80%, rgba(255,255,255,0.03) 0%, transparent 20%);\n        border-radius: 4px;\n        box-shadow: 0 6px 8px -10px rgba(0,0,0,0.6);\n        color: #d1d5db;\n        display: flex;\n        flex-direction: row; /* 关键：改为左右布局 */\n        overflow: hidden;\n        border: 1px solid #2d3748;\n    }\n\n    /* 动态水波背景层 */\n    .style-memory .card-content-wrapper::before {\n        content: '';\n        position: absolute;\n        top: -50%; left: -50%; width: 200%; height: 200%;\n        background: url(\"data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.6' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E\");\n        animation: drift 20s linear infinite;\n        opacity: 0.4;\n        pointer-events: none;\n    }\n\n    /* === 左侧：时间轴区域 === */\n    .style-memory .timeline-col {\n        flex: 0 0 50px; /* 固定宽度 */\n        border-right: 1px solid rgba(255,255,255,0.1);\n        position: relative;\n        background: rgba(0,0,0,0.2);\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        padding: 20px 0;\n        z-index: 2;\n    }\n\n    /* 贯穿的红线/金线 */\n    .style-memory .timeline-line {\n        position: absolute;\n        top: 0; bottom: 0; left: 50%;\n        width: 1px;\n        background: linear-gradient(to bottom, transparent, #a0aec0, rgba(192, 160, 128, 0.5), transparent);\n        transform: translateX(-50%);\n        z-index: 0;\n    }\n\n    /* 竖排的时间文字 */\n    .style-memory .time-text {\n        writing-mode: vertical-rl; /* 竖排 */\n        text-orientation: upright;\n        font-family: var(--font-serif);\n        font-size: 0.85em;\n        letter-spacing: 4px;\n        color: #94a3b8;\n        background: #1a1c20; /* 遮挡线条 */\n        padding: 10px 0;\n        z-index: 1;\n        border: 1px solid rgba(255,255,255,0.1);\n        border-radius: 4px;\n        box-shadow: 0 2px 5px rgba(0,0,0,0.3);\n    }\n\n    /* === 右侧：内容区域 === */\n    .style-memory .content-col {\n        flex: 1;\n        padding: 30px 25px;\n        display: flex;\n        flex-direction: column;\n        position: relative;\n        z-index: 2;\n    }\n\n    /* 装饰：右上角的卦象或符号 */\n    .style-memory .hex-decor {\n        position: absolute;\n        top: 15px; right: 15px;\n        font-size: 1.5em;\n        color: rgba(255,255,255,0.05);\n        font-family: serif;\n        pointer-events: none;\n    }\n\n    /* 记忆正文 */\n    .style-memory .memory-text {\n        font-family: var(--font-serif);\n        font-size: 1.05em;\n        line-height: 1.7;\n        text-align: justify;\n        color: #e2e8f0;\n        margin-bottom: auto; /* 把下方内容推到底部 */\n        text-shadow: 0 0 5px rgba(0,0,0,0.5);\n    }\n    \n    /* 首字下沉效果，增加古籍感 */\n    .style-memory .memory-text::first-letter {\n        font-size: 1.8em;\n        float: left;\n        margin-right: 5px;\n        line-height: 1;\n        color: #c0a080; /* 淡金 */\n    }\n\n    /* 分割线 */\n    .style-memory .sep-line {\n        width: 30px;\n        height: 1px;\n        background: #555;\n        margin: 20px 0;\n    }\n\n    /* 当下念头 */\n    .style-memory .thought-text {\n        font-family: var(--font-hand);\n        font-size: 0.95em;\n        color: #aebaba; /* 青灰色 */\n        font-style: italic;\n        position: relative;\n        padding-left: 10px;\n        border-left: 2px solid #5c6b7f;\n    }\n\n    /* 底部水印：模拟印章缺角 */\n    .style-memory .watermark {\n        position: absolute;\n        bottom: -20px; right: -20px;\n        width: 100px; height: 100px;\n        border: 1px solid rgba(255,255,255,0.05);\n        border-radius: 50%;\n        opacity: 0.5;\n        pointer-events: none;\n    }\n\n    @keyframes drift { from { transform: translate(-20%, -20%) rotate(0deg); } to { transform: translate(0%, 0%) rotate(5deg); } }\n\n    /* =================================================================== */\n    /* 4. 模式二：水墨信笺 (Postcard) */\n    /* =================================================================== */\n    .reverie-container.style-postcard { perspective: 1500px; width: 400px; height: 480px; }\n    \n    .card-flipper {\n        position: relative; width: 100%; height: 100%;\n        transform-style: preserve-3d; transition: transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1); cursor: pointer;\n    }\n    .style-postcard.is-flipped .card-flipper { transform: rotateY(180deg); }\n\n    .style-postcard .card-face {\n        position: absolute; top: 0; left: 0; width: 100%; height: 100%;\n        backface-visibility: hidden; border-radius: 4px; overflow: hidden;\n        box-shadow: 0 6px 8px rgba(0,0,0,0.2);\n        background: #fdfbf5;\n    }\n\n    /* 正面 */\n    .style-postcard .card-front {\n        display: flex; flex-direction: column; padding: 15px;\n        background-image: linear-gradient(to bottom, #fdfbf5 0%, #ece5ce 100%);\n    }\n    .style-postcard .photo-area {\n        flex: 1; background: #e0d8c0; position: relative;\n        display: flex; justify-content: center; align-items: center;\n        overflow: hidden; border: 1px solid #ccc;\n    }\n    /* 模拟水墨晕染 */\n    .style-postcard .photo-area::before {\n        content: ''; position: absolute; width: 120%; height: 120%;\n        background: radial-gradient(circle, rgba(0,0,0,0.1) 0%, transparent 60%);\n        filter: blur(20px);\n    }\n    .style-postcard .poster-text {\n        position: relative; z-index: 2; color: #333;\n        font-family: var(--font-title); font-size: 1.4em; writing-mode: vertical-rl;\n        letter-spacing: 5px; padding: 20px;\n    }\n    .style-postcard .front-caption {\n        height: 40px; display: flex; align-items: center; justify-content: flex-end;\n        font-size: 0.8em; color: #888; letter-spacing: 1px;\n    }\n\n    /* 背面 */\n    .style-postcard .card-back {\n        transform: rotateY(180deg);\n        background: #f4ecd8;\n        padding: 30px;\n        display: flex; flex-direction: column;\n    }\n    /* 竖排信纸格线 */\n    .style-postcard .writing-lines {\n        flex: 1; position: relative;\n        background-image: linear-gradient(to right, rgba(0,0,0,0.05) 1px, transparent 1px);\n        background-size: 40px 100%; /* 竖排间距 */\n        display: flex; flex-direction: row-reverse; /* 竖排从右向左 */\n        align-items: flex-start;\n        padding-right: 10px;\n        overflow: hidden;\n    }\n    .style-postcard .sender-signature {\n        writing-mode: vertical-rl;\n        font-family: var(--font-hand); font-size: 1.3em; color: #444;\n        line-height: 40px; height: 100%; white-space: pre-wrap;\n    }\n    \n    .style-postcard .stamp-box {\n        position: absolute; top: 20px; left: 20px; /* 古代信笺左侧或封口处 */\n        width: 40px; height: 40px; border: 2px solid #b5382e;\n        display: flex; justify-content: center; align-items: center;\n        color: #b5382e; writing-mode: vertical-rl; font-family: var(--font-title);\n        line-height: 18px;\n    }\n    .style-postcard .postmark-circle {\n        position: absolute; bottom: 20px; left: 20px;\n        font-size: 0.8em; color: #888;\n        font-family: var(--font-serif);\n    }\n\n    /* =================================================================== */\n    /* 5. 模式四：天命灵签 (Fortune - 雅致签文版) */\n    /* =================================================================== */\n    .style-fortune .card-content-wrapper {\n        position: relative;\n        /* 签文通常是细长的 */\n        width: 100%;\n        max-width: 280px; \n        min-height: 360px;\n        margin: 0 auto;\n        padding: 0;\n        background: transparent;\n        display: flex;\n        justify-content: center;\n        /* 微微的浮动动画 */\n        animation: floatPaper 6s ease-in-out infinite;\n    }\n\n    /* 签纸主体 */\n    .style-fortune .fortune-paper {\n        position: relative;\n        width: 100%;\n        background-color: #fdfbf5; /* 宣纸白 */\n        background-image: \n            /* 纸张噪点 */\n            url(\"data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.08'/%3E%3C/svg%3E\"),\n            /* 顶部边框纹样 */\n            linear-gradient(to bottom, transparent 98%, rgba(0,0,0,0.05) 100%);\n        box-shadow: \n            0 2px 5px rgba(0,0,0,0.05),\n            0 6px 8px rgba(0,0,0,0.1);\n        display: flex;\n        flex-direction: column;\n        padding: 30px 25px;\n        box-sizing: border-box;\n        overflow: hidden;\n        border-left: 1px solid rgba(0,0,0,0.05);\n        border-right: 1px solid rgba(0,0,0,0.05);\n    }\n\n    /* 背景水印 (八卦/太极，极淡) */\n    .style-fortune .fortune-paper::before {\n        content: '';\n        position: absolute;\n        top: 50%; left: 50%;\n        transform: translate(-50%, -50%);\n        width: 200px; height: 200px;\n        background-image: url(\"data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M50 0 L50 10 M50 90 L50 100 M0 50 L10 50 M90 50 L100 50' stroke='%23000' stroke-width='2' opacity='1'/%3E%3Ccircle cx='50' cy='50' r='30' stroke='%23000' stroke-width='1' fill='none' opacity='1'/%3E%3C/svg%3E\");\n        opacity: 0.03; /* 极淡 */\n        pointer-events: none;\n        z-index: 0;\n    }\n\n    /* 顶部：第几签/方式 */\n    .style-fortune .header-row {\n        text-align: center;\n        margin-bottom: 20px;\n        position: relative;\n        z-index: 2;\n    }\n    \n    .style-fortune .method-label {\n        font-family: var(--font-serif);\n        font-size: 0.8em;\n        color: #666;\n        letter-spacing: 4px;\n        margin-bottom: 8px;\n        display: block;\n    }\n\n    /* 核心：朱砂红印章样式的“上上签” */\n    .style-fortune .level-stamp {\n        display: inline-block;\n        border: 2px solid #b5382e; /* 朱砂红 */\n        color: #b5382e;\n        font-family: var(--font-title); /* 书法体 */\n        font-size: 2em;\n        padding: 5px 15px;\n        border-radius: 4px;\n        letter-spacing: 5px;\n        /* 模拟印章的不完美感 */\n        mask-image: url(\"data:image/svg+xml,%3Csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' fill='black'/%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.3'/%3E%3C/svg%3E\");\n        -webkit-mask-image: url(\"data:image/svg+xml,%3Csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' fill='black'/%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.3'/%3E%3C/svg%3E\");\n    }\n\n    /* 中部：判词 */\n    .style-fortune .content-body {\n        flex: 1;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: flex-start;\n        padding: 20px 0;\n        position: relative;\n        z-index: 2;\n    }\n\n    /* 竖线分割 */\n    .style-fortune .divider-v {\n        width: 1px; height: 30px;\n        background: linear-gradient(to bottom, transparent, #ccc, transparent);\n        margin: 10px 0;\n    }\n\n    .style-fortune .main-text {\n        font-family: var(--font-serif);\n        font-size: 1.1em;\n        line-height: 1.8;\n        color: #2c2c2c;\n        text-align: center; /* 保持横排阅读，但在视觉上居中 */\n        font-weight: 600;\n        margin-bottom: 5px;\n    }\n\n    .style-fortune .sub-text {\n        font-family: var(--font-serif);\n        font-size: 0.95em;\n        color: #555;\n        text-align: justify;\n        line-height: 1.6;\n        padding: 0 10px;\n    }\n\n    /* 底部：解签人与批注 */\n    .style-fortune .footer-section {\n        margin-top: auto;\n        border-top: 1px dashed rgba(0,0,0,0.1);\n        padding-top: 15px;\n        position: relative;\n        z-index: 2;\n    }\n\n    .style-fortune .master-sign {\n        text-align: left;\n        font-family: var(--font-hand);\n        font-size: 0.9em;\n        color: #888;\n        margin-bottom: 10px;\n    }\n\n    /* 角色吐槽：模拟侧边批注 */\n    .style-fortune .char-comment {\n        font-family: var(--font-hand);\n        color: #b5382e; /* 用红色模拟朱批 */\n        font-size: 1em;\n        line-height: 1.4;\n        background: rgba(181, 56, 46, 0.05); /* 极淡红底 */\n        padding: 8px;\n        border-radius: 4px;\n        position: relative;\n    }\n    \n    /* 批注前面的小红点 */\n    .style-fortune .char-comment::before {\n        content: '●'; font-size: 0.6em; color: #b5382e; margin-right: 5px; vertical-align: middle;\n    }\n\n    @keyframes floatPaper { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }\n\n</style>\n</head>\n<body>\n\n<div class=\"reverie-container\" id=\"reverieCard\"></div>\n\n<div id=\"raw-data\" style=\"display: none;\">\n$1\n</div>\n\n<script>\n    document.addEventListener('DOMContentLoaded', () => {\n        // --- 1. 数据获取与预处理 ---\n        const cardContainer = document.getElementById('reverieCard');\n        const rawData = document.getElementById('raw-data');\n        if (!cardContainer || !rawData) return;\n\n        const rawText = rawData.textContent.trim();\n        const activeModeMatch = rawText.match(/^(?:模式[:：])?(.*)\\n([\\s\\S]*)$/);\n        \n        let mode = 'excerpt'; \n        let content = rawText;\n\n        if (activeModeMatch) {\n            mode = activeModeMatch[1].trim(); \n            content = activeModeMatch[2];\n        } else {\n            content = rawText.trim();\n        }\n\n       const cleanSymbols = (str) => {\n            if (!str) return '';\n            return str.replace(/\\*\\*|__|\\*|_|~~/g, '').replace(/[()（）]/g, '').trim();\n        };\n\n        const lines = content.split('\\n').map(l => l.trim()).filter(Boolean).map(cleanSymbols);\n\n        // --- 2. 容器初始化 ---\n        cardContainer.innerHTML = '';\n        cardContainer.className = 'reverie-container';\n        cardContainer.classList.add(`style-${mode}`, 'active');\n\n        // --- 3. 模式构建逻辑 ---\n\n        // ==========================================\n        // Mode: Postcard (信笺)\n        // ==========================================\n        if (mode === 'postcard') {\n            const photoText = lines[0] || '山水一程';\n            const caption = lines[1] || '无题';\n            const senderMessage = lines.slice(2).join('\\n') || '...';\n            \n            const flipper = document.createElement('div');\n            flipper.className = 'card-flipper';\n            \n            flipper.innerHTML = `\n                <div class=\"card-face card-front\">\n                    <div class=\"photo-area\">\n                        <div class=\"poster-text\">${photoText.replace(/[()]/g, '')}</div>\n                    </div>\n                    <div class=\"front-caption\">${caption}</div>\n                </div>\n\n                <div class=\"card-face card-back\">\n                    <div class=\"stamp-box\">鸿雁<br>传书</div>\n                    <div class=\"writing-lines\">\n                        <div class=\"sender-signature\">${senderMessage}</div>\n                    </div>\n                    <div class=\"postmark-circle\">平安<br>顺遂</div>\n                </div>\n            `;\n            \n            cardContainer.appendChild(flipper);\n            cardContainer.addEventListener('click', () => {\n                cardContainer.classList.toggle('is-flipped');\n            });\n\n        } else if (mode === 'recommendation') {\n            // 输入处理：去除括号\n            const sharer = lines[0] ? lines[0].replace(/[()（）]/g, '') : '神秘人';\n            const fullTitle = lines[1] ? lines[1].replace(/[()（）]/g, '') : '无名之物';\n            \n            let item = fullTitle;\n            let source = '';\n            \n            const separators = [' 出自 ', ' / ', ' - '];\n            for (const sep of separators) {\n                if (fullTitle.includes(sep)) {\n                    const parts = fullTitle.split(sep);\n                    item = parts[0].trim();\n                    source = parts[1].trim();\n                    break;\n                }\n            }\n            \n            const message = lines[2] ? lines[2].replace(/[()（）]/g, '') : '赠予有缘人。';\n\n            const wrapper = document.createElement('div');\n            wrapper.className = 'card-content-wrapper';\n            \n            wrapper.innerHTML = `\n                <div class=\"giver-tag-container\">\n                    <div class=\"giver-tag\">\n                        ${sharer} 敬赠\n                    </div>\n                </div>\n\n                <div class=\"item-display\">\n                    <div class=\"item-main\">${item}</div>\n                    ${source ? `<div class=\"item-origin\">${source}</div>` : ''}\n                </div>\n\n                <div class=\"message-section\">\n                    <div class=\"message-text\">\n                        ${message}\n                    </div>\n                    <div class=\"seal-mark\">雅</div>\n                </div>\n            `;\n            cardContainer.appendChild(wrapper);\n\n        // ==========================================\n        // Mode: Memory (水月镜花版)\n        // ==========================================\n        } else if (mode === 'memory') {\n            const timeLoc = lines[0] ? lines[0].replace(/[()（）]/g, '') : '往事';\n            const memoryText = lines[1] ? lines[1].replace(/[()（）]/g, '') : '...';\n            const currentThought = lines[2] ? lines[2].replace(/[()（）]/g, '') : '';\n\n            // 随机生成一个装饰符号 (八卦符号或类似)\n            const decoSymbols = ['☷', '☶', '☵', '☴', '☳', '☲', '☱', '☰'];\n            const randomSymbol = decoSymbols[Math.floor(Math.random() * decoSymbols.length)];\n\n            const wrapper = document.createElement('div');\n            wrapper.className = 'card-content-wrapper';\n            \n            // 左右布局结构\n            wrapper.innerHTML = `\n                <div class=\"timeline-col\">\n                    <div class=\"timeline-line\"></div>\n                    <div class=\"time-text\">${timeLoc}</div>\n                </div>\n\n                <div class=\"content-col\">\n                    <div class=\"hex-decor\">${randomSymbol}</div>\n                    \n                    <div class=\"memory-text\">${memoryText}</div>\n                    \n                    ${currentThought ? `\n                        <div class=\"sep-line\"></div>\n                        <div class=\"thought-text\">\n                            ${currentThought}\n                        </div>\n                    ` : ''}\n                    \n                    <div class=\"watermark\"></div>\n                </div>\n            `;\n            cardContainer.appendChild(wrapper);\n\n        // ==========================================\n        // Mode: Fortune (灵签)\n        // ==========================================\n        } else if (mode === 'fortune') {\n            // Line 1: 测字 - 上上签\n            const firstLine = lines[0] ? lines[0].replace(/[()（）]/g, '') : '';\n            \n            // 修复解析逻辑：使用 ' - ' 或 '-' 分割，取最后一部分作为等级\n            let method = '问卜';\n            let level = '运势';\n            \n            if (firstLine.includes('-')) {\n                const parts = firstLine.split('-');\n                // 考虑到可能出现 \"测字 - 上上签\"，parts[0]是测字，parts[1]是上上签\n                // 如果没有空格也支持\n                method = parts[0].trim();\n                level = parts.length > 1 ? parts[1].trim() : '未定';\n            } else {\n                level = firstLine; // 如果没有横杠，整行都是等级\n            }\n\n            // Line 2: 核心判词\n            const mainTextRaw = lines[1] ? lines[1].replace(/[()（）]/g, '') : '...';\n            // 尝试将判词分为标题和解释 (如果中间有空格)\n            // 例如: \"潜龙勿用 困顿之时...\"\n            let mainTitle = mainTextRaw;\n            let mainDesc = '';\n            \n            // 简单的分割逻辑：第一个空格前是标题\n            const spaceIndex = mainTextRaw.indexOf(' ');\n            const commaIndex = mainTextRaw.indexOf('，');\n            \n            // 优先用空格分割，如果没有空格，就全当标题\n            if (spaceIndex > 0 && spaceIndex < 10) { \n                mainTitle = mainTextRaw.substring(0, spaceIndex);\n                mainDesc = mainTextRaw.substring(spaceIndex + 1).trim();\n            } else if (commaIndex > 0 && commaIndex < 10) {\n                 mainTitle = mainTextRaw.substring(0, commaIndex);\n                 mainDesc = mainTextRaw.substring(commaIndex).trim(); // 保留逗号\n            }\n\n            // Line 3: 解签人 (如果没有就空着)\n            const master = lines[2] ? lines[2].replace(/[()（）]/g, '') : '';\n\n            // Line 4: 角色吐槽\n            const comment = lines[3] ? lines[3].replace(/[()（）]/g, '') : '';\n\n            const wrapper = document.createElement('div');\n            wrapper.className = 'card-content-wrapper';\n            \n            // 动态生成HTML\n            wrapper.innerHTML = `\n                <div class=\"fortune-paper\">\n                    <div class=\"header-row\">\n                        <span class=\"method-label\">${method}</span>\n                        <div class=\"level-stamp\">${level}</div>\n                    </div>\n                    \n                    <div class=\"content-body\">\n                        <div class=\"main-text\">${mainTitle}</div>\n                        ${mainDesc ? `<div class=\"sub-text\">${mainDesc}</div>` : ''}\n                    </div>\n\n                    <div class=\"footer-section\">\n                        ${master ? `<div class=\"master-sign\">解曰：${master}</div>` : ''}\n                        ${comment ? `<div class=\"char-comment\">${comment}</div>` : ''}\n                    </div>\n                </div>\n            `;\n            cardContainer.appendChild(wrapper);\n\n        // ==========================================\n        // Mode: Excerpt (残卷 - Default)\n        // ==========================================\n        } else {\n            const mainText = lines[0] || '...';\n            const sourceText = lines[1] || '';\n            const noteText = lines[2] ? lines[2].replace(/[()]/g, '') : '';\n\n            const wrapper = document.createElement('div');\n            wrapper.className = 'card-content-wrapper';\n            wrapper.innerHTML = `\n                <div class=\"receipt-header\">\n                    <h1 class=\"brand-logo\">残卷 · 拾遗</h1>\n                </div>\n                <div class=\"item-section\">\n                    <span class=\"main-content\">${mainText}</span>\n                    ${sourceText ? `<div class=\"sub-content\">—— ${sourceText}</div>` : ''}\n                    ${noteText ? `<div class=\"simple-note\">${noteText}</div>` : ''}\n                </div>\n                <div class=\"stamp-seal\">阅</div>\n            `;\n            cardContainer.appendChild(wrapper);\n        }\n    });\n</script>\n</body>\n</html>\n```",
        "trimStrings": [],
        "placement": [
            2
        ],
        "disabled": false,
        "markdownOnly": true,
        "promptOnly": false,
        "runOnEdit": true,
        "substituteRegex": 0,
        "minDepth": null,
        "maxDepth": 10
    },
    {
        "id": "8cef2ce8-41cf-4627-9967-767dea759220",
        "scriptName": "象牙塔美化-角色状态|手机（1204）@电波系",
        "disabled": false,
        "runOnEdit": true,
        "findRegex": "/<通用状态>\\s+([\\s\\S]*?)</通用状态>/gi",
        "replaceString": "```html\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Pink OS Status Bar V4.5</title>\n    <!-- 引入图标 -->\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\n    <!-- 引入字体 -->\n    <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n    <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n    <link href=\"https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400;700&family=Press+Start+2P&display=swap\" rel=\"stylesheet\">\n    <style>\n        @import url(\"https://fontsapi.zeoseven.com/570/main/result.css\");\n\n        :root {\n            --phone-body: #fff0f5; \n            --phone-border: #e8d4e0;\n            --screen-bg: #fdf6fa;\n            --screen-text: #6d546a;\n            --dim-text: #9c8599;\n            --keypad-bg: #f8dbe8;\n            --key-bg: #f4e1ed;\n            --key-shadow: #dcbccf;\n            --key-text: #8b5f80;\n            --accent-pink: #ff80bf;\n            --accent-purple: #b185db;\n            --accent-blue: #8abcd1;\n            --bar-bg: #e6d3e0;\n        }\n\n        body {\n            font-family: 'Pixelify Sans', 'Fusion Pixel 12px M latin', sans-serif; \n            display: flex;\n            justify-content: center;\n            align-items: center;\n            margin: 10px;\n            user-select: none;\n            min-height: 780px;\n        }\n        \n        .nokia-handset {\n            max-width: 340px;\n            background: var(--phone-body);\n            border-radius: 30px;\n            border: 4px solid var(--phone-border);\n            box-shadow: \n                0 6px 8px rgba(189, 147, 175, 0.4),\n                inset 0 4px 10px rgba(255,255,255,0.8),\n                inset 0 -4px 10px rgba(0,0,0,0.05);\n            padding: 20px;\n            position: relative;\n        }\n\n        .screen-bezel {\n            background: #dcc2d6;\n            border-radius: 12px;\n            padding: 12px 12px 20px 12px;\n            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);\n            margin-bottom: 20px;\n        }\n\n        .nokia-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            color: #fff;\n            font-size: 12px; \n            padding: 0 4px 6px 4px;\n            font-family: 'Press Start 2P', cursive;\n            text-shadow: 1px 1px 0 rgba(0,0,0,0.1);\n        }\n        .status-icons { display: flex; gap: 6px; opacity: 0.9; font-size: 14px; }\n\n        .display-container {\n            height: 380px; \n            background: var(--screen-bg);\n            border: 2px solid #c4aebf;\n            border-radius: 4px;\n            position: relative;\n            overflow: hidden;\n            background-image: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.03) 50%);\n            background-size: 100% 3px;\n        }\n\n        .display-content {\n            padding: 14px;\n            color: var(--screen-text);\n            font-size: 17px;\n            line-height: 1.6;\n            height: 100%;\n            overflow-y: auto;\n            box-sizing: border-box;\n            scrollbar-width: none;\n            -ms-overflow-style: none;\n        }\n        .display-content::-webkit-scrollbar { display: none; }\n\n        .char-header {\n            text-align: center;\n            margin-bottom: 18px;\n            padding-bottom: 12px;\n            border-bottom: 2px dashed var(--phone-border);\n        }\n        .char-name {\n            font-size: 16px; \n            color: var(--accent-purple);\n            text-transform: uppercase;\n            letter-spacing: 1px;\n            line-height: 1.5;\n            text-shadow: 2px 2px 0px rgba(0,0,0,0.05);\n        }\n\n        .section { margin-bottom: 22px; }\n        .section h3 {\n            font-size: 14px;\n            font-family: 'Press Start 2P', cursive;\n            color: var(--accent-pink);\n            margin: 0 0 10px 0;\n            display: flex;\n            align-items: center;\n            gap: 8px;\n        }\n\n        .stat-block {\n            background: rgba(255,255,255,0.6);\n            padding: 10px;\n            border-radius: 8px;\n            border: 1px solid rgba(255,255,255,0.9);\n        }\n        .stat-header {\n            display: flex;\n            justify-content: space-between;\n            font-size: 14px;\n            font-weight: bold;\n            margin-bottom: 6px;\n            color: var(--accent-purple);\n            font-family: 'Press Start 2P', cursive;\n        }\n        .progress-track {\n            height: 14px;\n            background: var(--bar-bg);\n            border-radius: 7px;\n            overflow: hidden;\n            border: 1px solid #dcbccf;\n        }\n        .progress-fill {\n            height: 100%;\n            width: 0%;\n            transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);\n            position: relative;\n        }\n        .progress-fill::after {\n            content: '';\n            position: absolute;\n            top: 0; left: 0; right: 0; bottom: 0;\n            background-image: linear-gradient(45deg, rgba(255,255,255,0.3) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.3) 50%, rgba(255,255,255,0.3) 75%, transparent 75%, transparent);\n            background-size: 12px 12px;\n        }\n        .fill-favor { background: var(--accent-pink); }\n        .fill-lust { background: var(--accent-purple); }\n\n        .stat-note {\n            font-size: 14px;\n            color: var(--dim-text);\n            margin-top: 6px;\n            line-height: 1.4;\n            padding-left: 2px;\n            font-weight: 500;\n        }\n\n        .text-content { font-size: 16px; text-align: justify; }\n        \n        .quote-box {\n            border-left: 4px solid var(--accent-purple);\n            padding-left: 10px;\n            margin: 4px 0;\n            color: #7a6375;\n            font-style: italic;\n            background: rgba(189, 147, 249, 0.1);\n            padding: 8px 10px;\n            border-radius: 0 6px 6px 0;\n            font-size: 16px;\n        }\n\n        .organ-list p, .memo-list li { margin: 6px 0; font-size: 16px; }\n        .organ-tag {\n            display: inline-block;\n            background: var(--key-bg);\n            color: var(--key-text);\n            padding: 2px 6px;\n            border-radius: 4px;\n            font-size: 13px;\n            font-weight: bold;\n            margin-right: 6px;\n            border: 1px solid var(--phone-border);\n        }\n        \n        .memo-list { padding-left: 0; list-style: none; }\n        .memo-list li { position: relative; padding-left: 20px; }\n        .memo-list li::before {\n            content: '□';\n            position: absolute;\n            left: 0; font-size: 14px; top: 1px; color: var(--accent-blue);\n        }\n        .memo-list li.done { text-decoration: line-through; opacity: 0.6; }\n        .memo-list li.done::before { content: '■'; }\n\n        .doodle-box {\n            background: #fff;\n            border: 2px dashed #d1b8ca;\n            padding: 15px;\n            border-radius: 10px;\n            margin-top: 5px;\n            height: auto;\n            min-height: 50px;\n            overflow: hidden; \n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n        }\n\n        .ascii-art {\n            white-space: pre; \n            font-size: 13px;\n            line-height: 1.1; \n            text-align: center;\n            color: var(--accent-purple);\n            display: block;\n            width: 100%;\n        }\n\n        .doodle-cap {\n            font-size: 13px;\n            text-align: center;\n            color: var(--dim-text);\n            margin-top: 10px;\n            width: 100%;\n        }\n\n        .nokia-keypad { margin-top: 5px; }\n        \n        .multi-hint {\n            display: none; \n            text-align: center;\n            font-size: 10px;\n            color: var(--accent-purple);\n            margin-bottom: 8px;\n            animation: blinkHint 2s infinite;\n        }\n        @keyframes blinkHint {\n            0%, 100% { opacity: 0.5; }\n            50% { opacity: 1; text-shadow: 0 0 4px var(--accent-pink); }\n        }\n\n        .nav-area { display: flex; justify-content: center; gap: 15px; margin-bottom: 15px; }\n        .nav-btn {\n            background: #fff; border: 2px solid #e1dbe0;\n            padding: 8px 20px; border-radius: 12px;\n            color: var(--accent-pink); font-weight: bold;\n            box-shadow: 0 3px 0 #d1c8d0; cursor: pointer;\n            font-family: inherit; font-size: 14px;\n        }\n        .nav-btn:active { transform: translateY(3px); box-shadow: none; }\n        .num-pad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; padding: 0 10px; }\n        .key {\n            height: 36px; background: var(--key-bg);\n            border: 1px solid rgba(255,255,255,0.6);\n            border-radius: 10px; box-shadow: 0 3px 0 var(--key-shadow);\n            color: var(--key-text); display: flex;\n            justify-content: center; align-items: center;\n            font-weight: bold; font-size: 18px; cursor: default;\n        }\n    </style>\n</head>\n<body>\n\n    <div class=\"nokia-handset\">\n        <div class=\"screen-bezel\">\n            <div class=\"nokia-header\">\n                <span id=\"os-title\">PINK OS</span>\n                <div class=\"status-icons\">\n                    <i class=\"fa-solid fa-heart\"></i>\n                    <i class=\"fa-solid fa-battery-three-quarters\"></i>\n                </div>\n            </div>\n            <div class=\"display-container\">\n                <div class=\"display-content\" id=\"content-area\"></div>\n            </div>\n        </div>\n\n        <div class=\"nokia-keypad\">\n            <div id=\"multi-hint\" class=\"multi-hint\">\n                ⚠ 多人状态: 使用 [◄] [►] 翻页查看\n            </div>\n\n            <div class=\"nav-area\">\n                <button class=\"nav-btn\" id=\"prev\">◄</button>\n                <button class=\"nav-btn\" id=\"next\">►</button>\n            </div>\n            <div class=\"num-pad\">\n                <div class=\"key\">1</div><div class=\"key\">2</div><div class=\"key\">3</div>\n                <div class=\"key\">4</div><div class=\"key\">5</div><div class=\"key\">6</div>\n                <div class=\"key\">7</div><div class=\"key\">8</div><div class=\"key\">9</div>\n                <div class=\"key\">*</div><div class=\"key\">0</div><div class=\"key\">#</div>\n            </div>\n        </div>\n    </div>\n\n    <!-- 原始数据 -->\n    <div id=\"raw-data\" style=\"display: none;\">\n$1\n    </div>\n\n    <script>\n        document.addEventListener('DOMContentLoaded', () => {\n            const contentArea = document.getElementById('content-area');\n            const osTitle = document.getElementById('os-title');\n            const multiHint = document.getElementById('multi-hint');\n            const rawData = document.getElementById('raw-data').innerHTML;\n            \n            let characters = [];\n            let currentIndex = 0;\n\n            function parseData() {\n                // 宽容模式匹配正则\n                const charBlocks = rawData.match(/<(\\w+)[^>]*>([\\s\\S]*?)<\\/\\1>/g);\n                \n                if (charBlocks) {\n                    characters = charBlocks.map(block => {\n                        const extract = (regex) => {\n                            const match = block.match(regex);\n                            return match ? match[1].trim() : '';\n                        };\n                        const parseStat = (regex) => {\n                            const match = block.match(regex);\n                            if (!match) return { val: 0, note: '' };\n                            return { val: match[1], note: match[2] ? match[2].trim() : '' };\n                        };\n\n                        let doodleRaw = block.match(/随性涂鸦：\\n([\\s\\S]*?)涂鸦解析：/)?.[1] || '';\n                        doodleRaw = doodleRaw.replace(/^\\n+|\\n+$/g, '');\n\n                        const statRegex = /\\s*(-?\\d+(?:\\.\\d+)?)\\s*(?:[（(]([^\\n]*)[)）])?/;\n\n                        return {\n                            name: extract(/角色名称：(.*?)\\n/),\n                            favor: parseStat(new RegExp(\"好感指数：\" + statRegex.source)),\n                            mood: extract(/情绪气泡：(.*?)\\n/),\n                            secret: extract(/隐秘心声：(.*?)\\n/),\n                            lust: parseStat(new RegExp(\"性欲指数：\" + statRegex.source)),\n                            body: extract(/器官状态：([\\s\\S]*?)事务备忘：/),\n                            memo: extract(/事务备忘：([\\s\\S]*?)随性涂鸦：/),\n                            doodle: doodleRaw,\n                            doodleCaption: extract(/涂鸦解析：(.*?)\\n/)\n                        };\n                    });\n                }\n            }\n\n            function updateUIState() {\n                if (characters.length > 1) {\n                    multiHint.style.display = 'block';\n                    osTitle.textContent = `PINK OS [${currentIndex + 1}/${characters.length}]`;\n                } else {\n                    multiHint.style.display = 'none';\n                    osTitle.textContent = 'PINK OS';\n                }\n            }\n\n            function render(index) {\n                if (!characters[index]) return;\n                const char = characters[index];\n\n                // 更新界面状态（页码提示）\n                updateUIState();\n\n                const favorPercent = Math.min(100, Math.max(0, parseFloat(char.favor.val)));\n                const lustPercent = Math.min(100, Math.max(0, parseFloat(char.lust.val)));\n                \n                const memoHtml = char.memo.split('\\n').filter(line => line.trim()).map(line => {\n                    const isDone = line.includes('<s>') || line.includes('DONE');\n                    return `<li class=\"${isDone ? 'done' : ''}\">${line.replace(/<\\/?s>/g, '')}</li>`;\n                }).join('');\n                \n                const bodyLines = char.body.split('\\n').filter(line => line.trim() !== '');\n                const bodyHtml = bodyLines.map(line => {\n                    const processedLine = line.replace(/【.*?】/g, (match) => {\n                        return `<span class=\"organ-tag\">${match}</span>`;\n                    });\n                    return `<p>${processedLine}</p>`;\n                }).join('');\n\n                const html = `\n                    <div class=\"char-header\">\n                        <div class=\"char-name\">${char.name}</div>\n                    </div>\n                    <div class=\"section\">\n                        <h3><i class=\"fa-solid fa-heart-pulse\"></i> STATUS</h3>\n                        <div class=\"stat-block\">\n                            <div class=\"stat-header\"><span>FAVOR</span><span>${char.favor.val}</span></div>\n                            <div class=\"progress-track\"><div class=\"progress-fill fill-favor\" style=\"width: ${favorPercent}%\"></div></div>\n                            ${char.favor.note ? `<div class=\"stat-note\">${char.favor.note}</div>` : ''}\n                        </div>\n                        <div style=\"height:10px\"></div>\n                        <div class=\"stat-block\">\n                            <div class=\"stat-header\"><span>LUST</span><span>${char.lust.val}</span></div>\n                            <div class=\"progress-track\"><div class=\"progress-fill fill-lust\" style=\"width: ${lustPercent}%\"></div></div>\n                            ${char.lust.note ? `<div class=\"stat-note\">${char.lust.note}</div>` : ''}\n                        </div>\n                        <div style=\"margin-top:10px; font-size:14px; color:var(--dim-text)\">\n                            <i class=\"fa-regular fa-face-smile\"></i> ${char.mood.replace(/；/g, ' <span style=\"color:var(--accent-pink)\">/</span> ')}\n                        </div>\n                    </div>\n                    <div class=\"section\">\n                        <h3><i class=\"fa-solid fa-comment-dots\"></i> THOUGHTS</h3>\n                        <div class=\"quote-box text-content\">${char.secret.replace(/\\*/g, '')}</div>\n                    </div>\n                    <div class=\"section\">\n                        <h3><i class=\"fa-solid fa-person-rays\"></i> BODY_CHECK</h3>\n                        <div class=\"organ-list text-content\">${bodyHtml}</div>\n                    </div>\n                    <div class=\"section\">\n                        <h3><i class=\"fa-solid fa-list-check\"></i> TODO</h3>\n                        <ul class=\"memo-list\">${memoHtml}</ul>\n                    </div>\n                    <div class=\"section\">\n                        <h3><i class=\"fa-solid fa-pen-nib\"></i> DOODLE</h3>\n                        <div class=\"doodle-box\">\n                            <div class=\"ascii-art\">${char.doodle.replace(/</g, '&lt;')}</div>\n                            <div class=\"doodle-cap\">${char.doodleCaption}</div>\n                        </div>\n                    </div>\n                `;\n                contentArea.innerHTML = html;\n            }\n\n            parseData();\n            if (characters.length > 0) render(0);\n\n            document.getElementById('prev').addEventListener('click', () => {\n                if(characters.length > 1) {\n                    currentIndex = (currentIndex - 1 + characters.length) % characters.length;\n                    render(currentIndex);\n                }\n            });\n            document.getElementById('next').addEventListener('click', () => {\n                if(characters.length > 1) {\n                    currentIndex = (currentIndex + 1) % characters.length;\n                    render(currentIndex);\n                }\n            });\n        });\n    </script>\n</body>\n</html>\n```",
        "trimStrings": [],
        "placement": [
            2
        ],
        "substituteRegex": 0,
        "minDepth": null,
        "maxDepth": 10,
        "markdownOnly": true,
        "promptOnly": false
    },
    {
        "id": "c01a0a72-fc4a-4335-b460-cf6d066aeab5",
        "scriptName": "象牙塔美化-角色状态|古风（1222）@电波系",
        "findRegex": "/<古风状态>\\s+([\\s\\S]*?)</古风状态>/gi",
        "replaceString": "```html\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>浮生绘卷 @电波系</title>\n    \n    <style>\n        /* --- 字体库 --- */\n        @import url('https://static.zeoseven.com/zsft/256/main/result.css');\n        @import url(\"https://fontsapi.zeoseven.com/2/main/result.css\");\n        @import url(\"https://fontsapi-storage.zeoseven.com/111/main/result.css\");\n        @import url(\"https://fontsapi.zeoseven.com/874/main/result.css\");\n        @import url(\"https://fontsapi.zeoseven.com/489/main/result.css\");\n\n        :root {\n            --c-bg: #e0e4e8;\n            --c-paper: #f4f0e6;\n            --c-ink: #2b2626;\n            --c-ink-light: #5e504c;\n            --c-gold: #bfa46f;\n            --c-gold-text: #8c7648;\n            --c-cinnabar: #9e3636;\n            --c-jade: #2d423b;\n            --c-jade-light: #46635b;\n            \n            --f-title: 'Huiwen-Mincho', serif;\n            --f-body: 'LXGW ZhenKai GB', serif;\n            --f-art: 'Zhi Mang Xing', cursive;\n            --f-hand: 'ChillHuoKai', cursive;\n\n            /* 基础噪点 */\n            --tex-noise: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBvcGFjaXR5PSIwLjAzIj48ZmlsdGVyIGlkPSJub2lzZSI+PHZlVHVyYnVsZW5jZSB0eXBlPSJmcmFjdGFsTm9pc2UiIGJhc2VGcmVxdWVuY3k9IjAuNjUiIG51bU9jdGF2ZXM9IjMiIHN0aXRjaFRpbGVzPSJzdGl0Y2giLz48L2ZpbHRlcj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWx0ZXI9InVybCgjbm9pc2UpIi8+PC9zdmc+');\n            \n            /* 升级：云龙纸纤维纹理 (SVG模拟) */\n            --tex-fiber: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIj48ZyBvcGFjaXR5PSIwLjA1IiBzdHJva2U9IiNhMzhhNWIiIHN0cm9rZS13aWR0aD0iMC41Ij48cGF0aCBkPSJNMTAgMTBRMjAgNDAgNDAgMTAiIGZpbGw9Im5vbmUiLz48cGF0aCBkPSJNNTAgNTBRNjAgODAgOTAgNjAiIGZpbGw9Im5vbmUiLz48cGF0aCBkPSJNODAgMjBRNzAgNDAgNjAgMTAiIGZpbGw9Im5vbmUiLz48cGF0aCBkPSJNMjAgODBRNDAgNjAgNTAgOTAiIGZpbGw9Im5vbmUiLz48L2c+PC9zdmc+');\n\n            /* 粗糙草纸纹理 */\n            --tex-rough: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjJlYWRhIi8+PGZpbHRlciBpZD0ibm9pc2UiPjx2ZVR1cmJ1bGVuY2UgdHlwZT0iZnJhY3RhbE5vaXNlIiBiYXNlRnJlcXVlbmN5PSIwLjUiIG51bU9jdGF2ZXM9IjIiIHN0aXRjaFRpbGVzPSJzdGl0Y2giLz48L2ZpbHRlcj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWx0ZXI9InVybCgjbm9pc2UpIiBvcGFjaXR5PSIwLjEiLz48L3N2Zz4=');\n        }\n\n        body {\n            margin: 0; padding: 20px;\n            display: flex; justify-content: center; align-items: flex-start;\n            font-family: var(--f-body); color: var(--c-ink); \n            overflow-x: hidden;\n            box-sizing: border-box; /* 关键：防止全局溢出 */\n        }\n        \n        * { box-sizing: border-box; }\n\n        /* --- 核心容器：升级纸质纹理 --- */\n        .scroll-mount {\n            width: 100%; max-width: 500px;\n            /* 1. 基础纸色 */\n            background-color: var(--c-paper);\n            /* 2. 叠加纹理层：纤维 + 噪点 */\n            background-image: var(--tex-fiber), var(--tex-noise);\n            background-size: 200px 200px, 200px 200px;\n            background-blend-mode: multiply;\n            position: relative;\n            box-shadow: 0 6px 8px rgba(0,0,0,0.2);\n            border-radius: 6px;\n            overflow: hidden; \n            transition: all 0.3s;\n            border: 1px solid rgba(255,255,255,0.4);\n        }\n        /* 金线内框 */\n        .scroll-mount::after {\n            content: ''; position: absolute; top: 6px; bottom: 6px; left: 6px; right: 6px;\n            border: 1px double rgba(191, 164, 111, 0.5); border-radius: 4px;\n            pointer-events: none; z-index: 50;\n        }\n\n        /* --- 头部 --- */\n        .header-section {\n            background: linear-gradient(to bottom, \n                var(--c-jade) 0%, \n                var(--c-jade-light) 50%,\n                rgba(70, 99, 91, 0.0) 100%);\n            padding: 30px 0 30px;\n            text-align: center; cursor: pointer; position: relative; z-index: 20; user-select: none;\n        }\n\n        /* 标题 */\n        .main-title {\n            font-family: var(--f-title); \n            font-size: 2.5em; \n            letter-spacing: 12px;\n            color: #eaddcf;\n            text-shadow: 0 2px 10px rgba(0,0,0,0.3);\n            margin: 0;\n            position: relative;\n            display: inline-block;\n        }\n        .main-title::after {\n            content: ''; display: block; width: 40px; height: 2px;\n            background: rgba(234, 221, 207, 0.5); margin: 12px auto 0;\n        }\n\n        /* --- 竹叶 --- */\n        #bamboo-layer {\n            position: absolute; top: 0; left: 0; width: 100%; height: 100%;\n            pointer-events: none; z-index: 1; overflow: hidden; transition: opacity 0.5s;\n        }\n        .is-collapsed #bamboo-layer { opacity: 0; visibility: hidden; }\n        .falling-leaf {\n            position: absolute; background: linear-gradient(135deg, #8eb3a3, #4a6d66);\n            border-radius: 0 100% 0 100%; opacity: 0; \n            animation-name: leafFall; animation-timing-function: linear; animation-iteration-count: infinite;\n        }\n        @keyframes leafFall {\n            0% { top: -20px; transform: translateX(0) rotate(var(--r-start)); opacity: 0; }\n            10% { opacity: 0.8; }\n            90% { opacity: 0.8; }\n            100% { top: 105%; transform: translateX(var(--x-end)) rotate(var(--r-end)); opacity: 0; }\n        }\n\n        /* --- 折叠区 --- */\n        .collapsible-wrapper {\n            display: grid; grid-template-rows: 1fr;\n            transition: grid-template-rows 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);\n            position: relative; z-index: 10;\n        }\n        .is-collapsed .collapsible-wrapper { grid-template-rows: 0fr; }\n        .overflow-inner { overflow: hidden; min-height: 0; }\n        .content-body { padding: 15px 35px 20px; /* 底部留白给悬浮导航 */ }\n\n\n        /* --- 角色名区域 --- */\n        .char-hero { text-align: center; margin-bottom: 35px; position: relative; padding-top: 20px; }\n        .char-bg-text {\n            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -60%);\n            font-family: var(--f-art); font-size: 5em; color: var(--c-gold);\n            opacity: 0.12; white-space: nowrap; pointer-events: none; z-index: 0; letter-spacing: 10px;\n        }\n        .char-name {\n            font-family: var(--f-title); font-size: 2em; letter-spacing: 0.3em;\n            font-weight: bold; display: inline-block; position: relative; z-index: 1;\n            background: linear-gradient(120deg, var(--c-ink) 0%, var(--c-ink) 35%, #cfa972 50%, var(--c-ink) 65%, var(--c-ink) 100%);\n            background-size: 200% auto; -webkit-background-clip: text; -webkit-text-fill-color: transparent;\n            animation: shineText 20s cubic-bezier(0.4, 0, 0.2, 1) infinite;\n        }\n        @keyframes shineText { \n            0% { background-position: 200% center; }\n            100% { background-position: -200% center; }\n        }\n        .char-name::before, .char-name::after {\n            content: '✦'; font-size: 0.6em; color: var(--c-gold); vertical-align: middle; margin: 0 12px;\n            -webkit-text-fill-color: var(--c-gold);\n        }\n        .tags-wrapper {\n            margin-top: 15px; display: flex; justify-content: center; gap: 8px; flex-wrap: wrap; position: relative; z-index: 1;\n        }\n        .tag-pill {\n            font-family: var(--f-hand); font-size: 13px; color: var(--c-ink-light);\n            border: 1px solid rgba(0,0,0,0.1); background: rgba(255,255,255,0.6);\n            padding: 2px 10px; border-radius: 12px;\n        }\n\n        /* 属性条 */\n        .stat-group { margin-bottom: 50px; }\n        .stat-item { margin-bottom: 20px; }\n        .stat-header {\n            display: flex; justify-content: space-between; font-family: var(--f-title);\n            font-size: 0.9em; color: var(--c-ink-light); margin-bottom: 6px;\n            border-left: 3px solid var(--c-gold); padding-left: 10px;\n        }\n        .stat-track {\n            height: 15px; background: rgba(0,0,0,0.03); border: 1px solid rgba(191, 164, 111, 0.4);\n            border-radius: 2px; padding: 2px;\n        }\n        .stat-fill {\n            height: 100%; border-radius: 1px;\n            background-image: linear-gradient(45deg, rgba(255,255,255,0.25) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.25) 50%, rgba(255,255,255,0.25) 75%, transparent 75%, transparent);\n            background-size: 8px 8px;\n        }\n        .fill-fate { background-color: var(--c-jade); }\n        .fill-desire { background-color: var(--c-cinnabar); }\n\n        /* 标题基准样式 */\n        .common-title-style {\n            font-family: var(--f-title); font-size: 1.2em; color: var(--c-ink); \n            letter-spacing: 5px; font-weight: bold;\n        }\n\n        /* 灵台暗语 */\n        .letter-paper {\n            position: relative; background: #fdfbf7; padding: 35px 25px 35px; margin-bottom: 40px;\n            box-shadow: 0 5px 15px rgba(0,0,0,0.05);\n            background-image: repeating-linear-gradient(to right, transparent, transparent 29px, rgba(166, 58, 58, 0.08) 30px);\n            border-top: 1px solid #efe8d8; border-bottom: 1px solid #efe8d8;\n            transform: rotate(-1deg);\n        }\n        .letter-paper::after {\n            content: '❀'; position: absolute; bottom: 10px; right: 15px;\n            font-size: 24px; color: rgba(166, 58, 58, 0.15); font-family: serif;\n        }\n        .letter-header-box {\n            position: absolute; top: -14px; left: 50%; transform: translateX(-50%);\n            background: #fff; border: 1px solid #e0d8c8;\n            padding: 8px 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); z-index: 2;\n        }\n        .letter-title {\n            font-family: var(--f-title); font-size: 1.2em; letter-spacing: 5px; font-weight: bold; color: var(--c-cinnabar);\n        }\n        .letter-content {\n            font-family: var(--f-hand); font-size: 1.15em; line-height: 1.5;\n            color: var(--c-ink); text-align: justify;\n        }\n\n        /* 肉身反馈 */\n        .tcm-record {\n            background-color: #f2eada; background-image: var(--tex-rough);\n            padding: 30px 20px 20px; margin-bottom: 40px;\n            border: 1px solid rgba(0,0,0,0.1); position: relative;\n            box-shadow: inset 0 0 40px rgba(139, 119, 101, 0.15), 0 4px 15px rgba(0,0,0,0.1);\n        }\n        .tcm-record::before {\n            content: '诊'; position: absolute; top: 10px; right: 10px;\n            font-family: var(--f-title); font-size: 60px; color: #8b7765;\n            opacity: 0.1; pointer-events: none; z-index: 0;\n            border: 3px solid #8b7765; border-radius: 50%; width: 80px; height: 80px;\n            display: flex; align-items: center; justify-content: center; transform: rotate(10deg);\n        }\n        .tcm-header {\n            text-align: center; margin-bottom: 15px; border-bottom: 2px solid #5a6e65;\n            padding-bottom: 10px; position: relative; z-index: 1;\n        }\n        .tcm-title {\n            font-family: var(--f-title); font-size: 1.2em; letter-spacing: 5px; font-weight: bold; color: #2d3834;\n        }\n        .tcm-grid {\n            display: grid; grid-template-columns: 1fr; border: 1px solid #9c9285; margin-top: 10px;\n            position: relative; z-index: 1; background: rgba(255,255,255,0.2);\n        }\n        .tcm-row {\n            display: grid; grid-template-columns: 80px 1fr; border-bottom: 1px solid #9c9285; min-height: 38px;\n        }\n        .tcm-row:last-child { border-bottom: none; }\n        .tcm-label {\n            background: rgba(139, 119, 101, 0.08); color: #5e504c;\n            display: flex; align-items: center; justify-content: center;\n            font-family: var(--f-title); font-size: 0.9em; border-right: 1px solid #9c9285;\n        }\n        .tcm-value {\n            padding: 8px 12px; font-family: var(--f-hand); font-size: 1em; color: #2b2626;\n            display: flex; align-items: center; mix-blend-mode: multiply; line-height: 1.5;\n        }\n\n        /* 红尘俗务 */\n        .task-section { margin-bottom: 50px; }\n        .task-header-beam {\n            display: flex; align-items: center; justify-content: center; margin-bottom: 25px;\n        }\n        .beam-line { flex: 1; height: 1px; background: rgba(117, 92, 72, 0.3); }\n        .beam-title {\n            font-family: var(--f-title); font-size: 1.2em; color: var(--c-ink);\n            margin: 0 20px; letter-spacing: 5px; font-weight: bold;\n        }\n        .beam-deco { color: var(--c-gold); font-size: 12px; }\n\n        .tasks-container { display: flex; flex-wrap: wrap; gap: 15px; justify-content: space-between; }\n        .task-plaque {\n            width: 48%; box-sizing: border-box;\n            background: radial-gradient(circle at 30% 30%, #fffef9 0%, #f4f0e6 100%);\n            border: 1px solid rgba(255, 255, 255, 0.6);\n            box-shadow: 0 4px 8px rgba(180, 170, 150, 0.2), inset 0 0 20px rgba(255, 255, 255, 0.9);\n            border-radius: 6px; padding: 12px 14px; min-height: 64px;\n            display: flex; align-items: center; position: relative;\n            font-family: var(--f-hand); font-size: 1.05em; line-height: 1.4; color: #5c4a40;\n            backdrop-filter: blur(2px);\n        }\n        .task-plaque::before {\n            content: ''; position: absolute; top: -6px; left: 50%; transform: translateX(-50%);\n            width: 6px; height: 6px; background: #333; border-radius: 50%;\n            border: 2px solid #cfa972; box-shadow: 0 1px 2px rgba(0,0,0,0.2);\n        }\n        .stamp-finished {\n            display: none; position: absolute; right: 5px; bottom: 5px; width: 46px; height: 24px;\n            border: 2px solid rgba(166, 58, 58, 0.6); color: rgba(166, 58, 58, 0.8);\n            font-family: var(--f-title); font-size: 13px; font-weight: bold;\n            align-items: center; justify-content: center; transform: rotate(-15deg); border-radius: 4px;\n            background: rgba(166, 58, 58, 0.05);\n        }\n        .task-done { opacity: 0.9; }\n        .task-done .task-text { opacity: 0.5; text-decoration: line-through; text-decoration-color: rgba(0,0,0,0.1); } \n        .task-done .stamp-finished { display: flex; }\n\n        /* 涂鸦装裱 */\n        .art-mounting {\n            background-color: #e8e4d8; \n            background-image: \n                radial-gradient(circle at 100% 100%, rgba(255,255,255,0.8) 10%, transparent 11%),\n                radial-gradient(circle at 0% 0%, rgba(255,255,255,0.8) 10%, transparent 11%);\n            background-size: 20px 20px;\n            padding: 20px; margin-top: 30px; position: relative;\n            box-shadow: inset 0 0 15px rgba(0,0,0,0.05);\n            border: 1px solid #d0c8b0;\n        }\n        .art-mounting::before, .art-mounting::after {\n            content: ''; position: absolute; left: 10px; right: 10px; height: 6px;\n            background: linear-gradient(to right, #8c7648, #d4c5a3, #8c7648);\n            border-radius: 3px; box-shadow: 0 2px 4px rgba(0,0,0,0.2); z-index: 2;\n        }\n        .art-mounting::before { top: -3px; } .art-mounting::after { bottom: -3px; }\n\n        .art-paper {\n            background: #fff; padding: 25px 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);\n            min-height: 100px; position: relative;\n        }\n        .ascii-display {\n            font-family: 'Courier New', monospace; font-size: 11px; line-height: 1.1;\n            white-space: pre; overflow-x: auto; text-align: center; color: #555; height: auto;\n        }\n        .art-footer {\n            text-align: center; margin-top: 15px; font-family: var(--f-art);\n            color: var(--c-ink); font-size: 1em;\n        }\n        .seal-mark {\n            display: inline-block; width: 22px; height: 22px; line-height: 22px;\n            background: #a83b3b; color: white; font-size: 11px;\n            border-radius: 3px; margin-left: 8px; font-family: serif; vertical-align: text-bottom;\n            box-shadow: 1px 1px 2px rgba(0,0,0,0.2);\n        }\n\n        /* --- 2. 底部导航 (完全重构) --- */\n        .footer-float-bar {\n            /* 布局定位 */\n            display: flex; justify-content: space-between; align-items: center;\n            width: 90%;\n            max-width: 320px;\n            margin: 0 auto;\n            margin-top: 20px;\n            padding: 8px 12px;\n            \n            /* 样式：如意云头/玉石胶囊 */\n            background: rgba(255, 252, 245, 0.9);\n            border-radius: 50px;\n            border: 1px solid rgba(191, 164, 111, 0.5);\n            box-shadow: 0 4px 15px rgba(0,0,0,0.1);\n            backdrop-filter: blur(5px);\n            \n            /* 防止溢出 */\n            box-sizing: border-box;\n        }\n\n        .nav-btn {\n            font-family: var(--f-title); font-size: 14px; color: var(--c-ink-light);\n            cursor: pointer; padding: 6px 12px;\n            border-radius: 20px; transition: all 0.3s;\n            display: flex; align-items: center; gap: 4px;\n            user-select: none;\n        }\n        .nav-btn:hover {\n            background: rgba(191, 164, 111, 0.15);\n            color: var(--c-gold-text);\n        }\n        .nav-btn:active { transform: scale(0.95); }\n        \n        /* 按钮装饰：小印章点 */\n        .nav-btn::before {\n            content: ''; width: 6px; height: 6px; background: var(--c-cinnabar);\n            border-radius: 50%; opacity: 0.5;\n        }\n\n        .page-num {\n            font-family: var(--f-title); font-size: 14px; color: var(--c-gold-text);\n            padding: 0 10px;\n            border-left: 1px solid rgba(0,0,0,0.1);\n            border-right: 1px solid rgba(0,0,0,0.1);\n            letter-spacing: 2px;\n            white-space: nowrap;\n        }\n        .hidden { display: none !important; }\n\n        @media (max-width: 480px) {\n            body { padding: 10px 2px 10px 2px;}\n            .scroll-mount { box-shadow: 0 4px 6px rgba(0,0,0,0.15); }\n            .task-plaque { width: 100%; }\n            .content-body { padding: 10px 20px 20px; }\n            .footer-float-bar { width: 95%; padding: 6px 10px; } \n            .letter-header-box { padding: 6px 8px; }\n      }\n        }\n    </style>\n</head>\n<body>\n\n    <div class=\"scroll-mount is-collapsed\" id=\"main-container\">\n        <!-- 竹叶 -->\n        <div id=\"bamboo-layer\"></div>\n        \n        <!-- 头部 -->\n        <div class=\"header-section\" id=\"header-trigger\">\n            <h1 class=\"main-title\">浮生绘卷</h1>\n        </div>\n\n        <div class=\"collapsible-wrapper\">\n            <div class=\"overflow-inner\">\n                <div class=\"content-body\" id=\"content-body\">\n                    <!-- 动态内容 -->\n                </div>\n                \n                <!-- 底部导航重构 -->\n                <div class=\"footer-float-bar hidden\" id=\"footer-nav\">\n                    <div class=\"nav-btn\" id=\"prev\">前尘</div>\n                    <div class=\"page-num\" id=\"page-indicator\">壹 · 壹</div>\n                    <div class=\"nav-btn\" id=\"next\">后事</div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id=\"raw-data\" style=\"display: none;\">\n$1\n    </div>\n\n    <script>\n        document.addEventListener('DOMContentLoaded', () => {\n            \n            // --- 竹叶系统 (保持不变) ---\n            function initBamboo() {\n                const container = document.getElementById('bamboo-layer');\n                // 稍微减少数量，避免遮挡文字\n                const leafCount = 10;\n                for(let i=0; i<leafCount; i++) {\n                    const leaf = document.createElement('div');\n                    leaf.classList.add('falling-leaf');\n                    \n                    const width = Math.random() * 8 + 6; \n                    leaf.style.width = `${width}px`;\n                    leaf.style.height = `${width * 2}px`;\n                    leaf.style.left = `${Math.random() * 100}%`;\n\n                    const duration = Math.random() * 5 + 8; \n                    const delay = Math.random() * -10; \n\n                    leaf.style.setProperty('--r-start', Math.random() * 360 + 'deg');\n                    leaf.style.setProperty('--r-end', (Math.random() * 360 + 360) + 'deg');\n                    leaf.style.setProperty('--x-end', (Math.random() * 100 - 50) + 'px');\n                    \n                    leaf.style.animationDuration = `${duration}s`;\n                    leaf.style.animationDelay = `${delay}s`;\n\n                    container.appendChild(leaf);\n                }\n            }\n            \n            const rawData = document.getElementById('raw-data').innerHTML;\n            const contentBody = document.getElementById('content-body');\n            const mainContainer = document.getElementById('main-container');\n            const footerNav = document.getElementById('footer-nav');\n            const pageIndicator = document.getElementById('page-indicator');\n            \n            let characters = [];\n            let currentIndex = 0;\n            let isCollapsed = true;\n\n            const cnNums = ['零', '壹', '贰', '叁', '肆', '伍', '陆', '柒', '捌', '玖'];\n            const toCnNum = (n) => (n <= 9) ? cnNums[n] : n;\n\n            document.getElementById('header-trigger').addEventListener('click', () => {\n                isCollapsed = !isCollapsed;\n                if(isCollapsed) mainContainer.classList.add('is-collapsed');\n                else mainContainer.classList.remove('is-collapsed');\n            });\n\n            function parseData() {\n                const blocks = rawData.match(/<(\\w+)[^>]*>([\\s\\S]*?)<\\/\\1>/g);\n                if(blocks) {\n                    characters = blocks.map(b => {\n                        const get = (r) => (b.match(r) || [])[1]?.trim() || '';\n                        // 修正：支持读取小数，例如 0.0 或 50.5\n                        const getNum = (r) => parseFloat((b.match(r) || [])[1]) || 0;\n                        \n                        let art = b.match(/笔墨丹青：\\n([\\s\\S]*?)笔墨题跋/)?.[1] || '';\n                        art = art.replace(/^\\n+|\\n+$/g, '');\n                        \n                        // 修正正则：允许匹配小数位\n                        return {\n                            name: get(/人物名讳：(.*?)\\n/),\n                            fateNum: getNum(/世俗尘缘：\\s*(-?\\d+(?:\\.\\d+)?)/),\n                            mood: get(/当前心境：(.*?)\\n/),\n                            innerVoice: get(/灵台暗语：([\\s\\S]*?)心之欲念/),\n                            desireNum: getNum(/心之欲念：\\s*(\\d+(?:\\.\\d+)?)/),\n                            bodyCheck: get(/肉身反馈：\\n([\\s\\S]*?)红尘俗务/),\n                            tasks: get(/红尘俗务：\\n([\\s\\S]*?)笔墨丹青/),\n                            ascii: art,\n                            caption: get(/笔墨题跋：(.*?)\\n/)\n                        };\n                    });\n                }\n            }\n\n            function render(index) {\n                if(!characters[index]) return;\n                const char = characters[index];\n\n                if(characters.length > 1) {\n                    footerNav.classList.remove('hidden');\n                    pageIndicator.textContent = `${toCnNum(index+1)} · ${toCnNum(characters.length)}`;\n                } else {\n                    footerNav.classList.add('hidden');\n                }\n\n                // 修正进度条逻辑：完全按照数值 0-100 显示\n                // 0 就是 0%，50 就是 50%\n                let fatePer = Math.min(100, Math.max(0, char.fateNum));\n                let desirePer = Math.min(100, Math.max(0, char.desireNum));\n\n                const moodHtml = char.mood.split(/[；;]/).filter(t=>t).map(t => \n                    `<div class=\"tag-pill\">${t}</div>`\n                ).join('');\n\n                const bodyRows = char.bodyCheck.split('\\n').filter(l=>l).map(l => {\n                    const match = l.match(/【(.*?)】\\s*[：:]?\\s*(.*)/);\n                    const organ = match ? match[1] : '躯干';\n                    const desc = match ? match[2] : l;\n                    return `\n                        <div class=\"tcm-row\">\n                            <div class=\"tcm-label\">${organ}</div>\n                            <div class=\"tcm-value\">${desc}</div>\n                        </div>`;\n                }).join('');\n\n                const taskHtml = char.tasks.split('\\n').filter(l=>l).map(l => {\n                    const isDone = l.includes('<s>') || l.includes('DONE');\n                    const txt = l.replace(/<\\/?s>/g, '').replace(/^-\\s*/, '').trim();\n                    return `\n                        <div class=\"task-plaque ${isDone?'task-done':''}\">\n                            <span class=\"task-text\">${txt}</span>\n                            <div class=\"stamp-finished\">终了</div>\n                        </div>`;\n                }).join('');\n\n                const html = `\n                    <div class=\"char-hero\">\n                        <div class=\"char-bg-text\">天地玄黄</div>\n                        <div class=\"char-name\">${char.name}</div>\n                        <div class=\"tags-wrapper\">${moodHtml}</div>\n                    </div>\n\n                    <div class=\"stat-group\">\n                        <div class=\"stat-item\">\n                            <div class=\"stat-header\"><span>世俗尘缘</span><span>${char.fateNum}</span></div>\n                            <div class=\"stat-track\"><div class=\"stat-fill fill-fate\" style=\"width:${fatePer}%\"></div></div>\n                        </div>\n                        <div class=\"stat-item\">\n                            <div class=\"stat-header\"><span>心之欲念</span><span>${char.desireNum}</span></div>\n                            <div class=\"stat-track\"><div class=\"stat-fill fill-desire\" style=\"width:${desirePer}%\"></div></div>\n                        </div>\n                    </div>\n\n                    <div class=\"letter-paper\">\n                        <div class=\"letter-header-box\">\n                            <span class=\"letter-title\">灵台暗语</span>\n                        </div>\n                        <div class=\"letter-content\">${char.innerVoice}</div>\n                    </div>\n\n                    <div class=\"tcm-record\">\n                        <div class=\"tcm-header\">\n                            <span class=\"tcm-title\">肉身反馈</span>\n                        </div>\n                        <div class=\"tcm-grid\">\n                            ${bodyRows}\n                        </div>\n                    </div>\n\n                    <div class=\"task-section\">\n                        <div class=\"task-header-beam\">\n                            <div class=\"beam-line\"></div>\n                            <span class=\"beam-deco\">✦</span>\n                            <div class=\"beam-title\">红尘俗务</div>\n                            <span class=\"beam-deco\">✦</span>\n                            <div class=\"beam-line\"></div>\n                        </div>\n                        <div class=\"tasks-container\">${taskHtml}</div>\n                    </div>\n\n                    <div class=\"art-mounting\">\n                        <div class=\"art-paper\">\n                            <div class=\"ascii-display\">${char.ascii.replace(/</g, '&lt;')}</div>\n                            <div class=\"art-footer\">\n                                ${char.caption} <span class=\"seal-mark\">绘</span>\n                            </div>\n                        </div>\n                    </div>\n                `;\n\n                contentBody.innerHTML = html;\n            }\n\n            document.getElementById('prev').addEventListener('click', () => {\n                if(characters.length>1) {\n                    currentIndex = (currentIndex - 1 + characters.length) % characters.length;\n                    render(currentIndex);\n                }\n            });\n            document.getElementById('next').addEventListener('click', () => {\n                if(characters.length>1) {\n                    currentIndex = (currentIndex + 1) % characters.length;\n                    render(currentIndex);\n                }\n            });\n\n            parseData();\n            if(characters.length > 0) render(0);\n            \n            initBamboo();\n        });\n    </script>\n</body>\n</html>\n```",
        "trimStrings": [],
        "placement": [
            2
        ],
        "disabled": true,
        "markdownOnly": true,
        "promptOnly": false,
        "runOnEdit": true,
        "substituteRegex": 0,
        "minDepth": null,
        "maxDepth": 10
    },
    {
        "id": "ea2c35bc-3340-485a-8309-d2c0bf7a5753",
        "scriptName": "象牙塔美化-文末吐槽美化（0106）@电波系",
        "findRegex": "/<gossip>\\s+([\\s\\S]*?)</gossip>/gi",
        "replaceString": "```html\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n<meta charset=\"UTF-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<title>文末吐槽美化 @电波系</title>\n<style>\n    /* 全局样式 */\n    body {\n        font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        margin: 0;\n        padding: 10px;\n        box-sizing: border-box;\n    }\n    /* 聊天窗口容器 */\n    .chat-container {\n        width: 100%;\n        max-width: 480px;\n        background-color: #ffffff;\n        border-radius: 20px;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n        display: flex;\n        flex-direction: column;\n        overflow: hidden;\n    }\n    /* 聊天窗口头部 */\n    .chat-header {\n        background-color: #ffffff;\n        padding: 16px 20px;\n        border-bottom: 1px solid #e0e0e0;\n        text-align: center;\n    }\n    .chat-header h1 {\n        margin: 0;\n        font-size: 18px;\n        font-weight: 600;\n        color: #333;\n    }\n    /* 聊天消息区域 */\n    .chat-messages {\n        flex-grow: 1;\n        padding: 30px 20px;\n        overflow-y: auto;\n        display: flex;\n        flex-direction: column;\n        gap: 20px;\n    }\n    /* 单条消息 - 动画初始状态 */\n    .message {\n        display: flex;\n        align-items: flex-start;\n        max-width: 85%;\n        align-self: flex-start; /* 默认靠左对齐 */\n        opacity: 0; /* 初始不可见 */\n        transform: translateY(15px); /* 初始位置在下方15px */\n    }\n    /* 触发动画的类 */\n    .message.animate-in {\n        animation: fadeInUp 0.5s ease-out forwards;\n    }\n    /* 头像 */\n    .avatar {\n        width: 42px;\n        height: 42px;\n        border-radius: 50%;\n        background-color: #e9ecef;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        font-size: 24px;\n        margin-right: 12px;\n        flex-shrink: 0;\n        user-select: none;\n        transition: transform 0.2s ease;\n    }\n    .avatar:hover {\n        transform: scale(1.1);\n    }\n    /* 消息内容区 */\n    .message-content {\n        display: flex;\n        flex-direction: column;\n    }\n    /* 用户名 */\n    .username {\n        font-size: 14px;\n        color: #666;\n        margin-bottom: 6px;\n        cursor: default;\n    }\n    /* 消息气泡 - 注意：背景色由JS设定 */\n    .bubble {\n        border-radius: 18px;\n        padding: 12px 16px;\n        font-size: 16px;\n        line-height: 1.5;\n        color: #333;\n        word-wrap: break-word;\n        white-space: pre-wrap;\n        border-top-left-radius: 4px;\n    }\n\n    .bubble span.gif-text {\n        font-style: italic; color: #888; background-color: rgba(0,0,0,0.05);\n        padding: 2px 6px; border-radius: 4px;\n    }\n    \n    /* 定义兼容的 @keyframes 动画 */\n    @keyframes fadeInUp {\n        from {\n            opacity: 0;\n            transform: translateY(15px);\n        }\n        to {\n            opacity: 1;\n            transform: translateY(0);\n        }\n    }\n\n    /* ================= 移动端布局优化 ================= */\n    @media screen and (max-width: 480px) {\n        .chat-messages {\n            padding: 20px 15px;\n            gap: 25px; /* 增加垂直间距 */\n        }\n\n        .chat-header h1 {\n            font-size: 1em;\n        }\n\n        /* 1. 消息容器改为块级+相对定位 */\n        .message {\n            display: block;\n            position: relative;\n            padding-top: 30px; /* 为头像和名字留出空间 */\n            max-width: 100%;\n        }\n\n        /* 2. 头像缩小并绝对定位到左上角 */\n        .avatar {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 20px;\n            height: 20px;\n            font-size: 12px;\n            line-height: 20px; /* 确保emoji居中 */\n            margin-right: 0;\n        }\n\n        /* 3. 用户名绝对定位到头像右侧 */\n        .username {\n            position: absolute;\n            top: 1px; /* 微调垂直位置 */\n            left: 28px;\n            margin-bottom: 0;\n            font-size: 12px;\n        }\n\n        /* 4. 气泡全宽显示 */\n        .bubble {\n            font-size: 14px;\n            width: 100%;\n            box-sizing: border-box; /* 确保padding不会撑开宽度 */\n        }\n    }\n</style>\n</head>\n<body>\n\n<div class=\"chat-container\">\n    <div class=\"chat-header\">\n        <h1 id=\"group-name\">Parsing...</h1>\n    </div>\n    <div class=\"chat-messages\" id=\"chat-messages\"></div>\n</div>\n\n<div id=\"raw-data\" style=\"display: none;\">\n$1\n</div>\n\n<script>\ndocument.addEventListener('DOMContentLoaded', function() {\n    // --- Setup ---\n    const rawDataElement = document.getElementById('raw-data');\n    const groupNameElement = document.getElementById('group-name');\n    const chatMessagesContainer = document.getElementById('chat-messages');\n    \n    const pastelColors = [\n        '#E6F3FF', '#FFEBE6', '#E6F8F0', '#F0EAFF', '#FFF8E1',\n        '#FEEEEE', '#E3FDFD', '#F5F5F5', '#E5F7EE', '#FFF0F5'\n    ];\n\n    // Fisher-Yates 洗牌算法\n    const shuffleArray = (array) => {\n        let currentIndex = array.length, randomIndex;\n        while (currentIndex !== 0) {\n            randomIndex = Math.floor(Math.random() * currentIndex);\n            currentIndex--;\n            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];\n        }\n        return array;\n    };\n\n    const shuffledColors = shuffleArray([...pastelColors]);\n\n    // --- 解析逻辑 ---\n    const rawText = rawDataElement.textContent;\n    // 过滤掉空行，避免多余处理\n    const lines = rawText.split('\\n').filter(line => line.trim() !== '');\n    \n    const groupNameRegex = /【(.*?)】/;\n    const messageRegex = /(.+?)[：:](.*)/;\n    const cleanupRegex = /^\\s*[>—\\s]*/;\n    \n    let messageCounter = 0; \n\n    const groupNameMatch = rawText.match(groupNameRegex);\n    // 如果抓取到了标题，就用抓取的，否则显示默认\n    groupNameElement.textContent = groupNameMatch ? groupNameMatch[1].trim() : \"群组对话\";\n\n    lines.forEach((line) => {\n        // 1. 清理行首的引用符号 >、破折号 — 和空格\n        const cleanedLine = line.replace(cleanupRegex, '').trim();\n        if (!cleanedLine) return;\n\n        // 2. 解析 名字: 内容\n        const messageMatch = cleanedLine.match(messageRegex);\n        \n        if (messageMatch) {\n            const userBlock = messageMatch[1].trim();\n            const messageText = messageMatch[2].trim();\n\n            if (!userBlock) return;\n\n            // ==========================================\n            // 【关键修改】检测是否误判了标题行\n            // 如果“用户名”部分是以 【 开头的，说明这其实是标题行，直接跳过\n            // ==========================================\n            if (userBlock.startsWith('【')) {\n                return; \n            }\n\n            // 正常的头像提取逻辑\n            const avatar = [...userBlock][0]; \n            const username = userBlock.substring(avatar.length).trim();\n\n            // 创建 DOM 元素\n            const messageDiv = document.createElement('div');\n            messageDiv.className = 'message';\n            \n            const avatarDiv = document.createElement('div');\n            avatarDiv.className = 'avatar';\n            avatarDiv.textContent = avatar;\n            \n            const messageContentDiv = document.createElement('div');\n            messageContentDiv.className = 'message-content';\n\n            const usernameDiv = document.createElement('div');\n            usernameDiv.className = 'username';\n            usernameDiv.textContent = username;\n\n            const bubbleDiv = document.createElement('div');\n            bubbleDiv.className = 'bubble';\n            \n            // 设置背景色\n            bubbleDiv.style.backgroundColor = shuffledColors[messageCounter % shuffledColors.length];\n\n            // 处理括号中的动作文字\n            const processedMessageHTML = messageText.replace(\n                /[(（](.*?)[)）]/g, // 稍微扩展了一下，匹配中英文括号\n                (match) => `<span class=\"gif-text\">${match}</span>`\n            );\n            bubbleDiv.innerHTML = processedMessageHTML;\n\n            messageContentDiv.appendChild(usernameDiv);\n            messageContentDiv.appendChild(bubbleDiv);\n            messageDiv.appendChild(avatarDiv);\n            messageDiv.appendChild(messageContentDiv);\n            chatMessagesContainer.appendChild(messageDiv);\n\n            // 触发动画\n            setTimeout(() => {\n                messageDiv.classList.add('animate-in');\n            }, messageCounter * 150);\n            \n            messageCounter++; \n        }\n    });\n});\n</script>\n\n</body>\n</html>\n```",
        "trimStrings": [],
        "placement": [
            2
        ],
        "disabled": false,
        "markdownOnly": true,
        "promptOnly": false,
        "runOnEdit": true,
        "substituteRegex": 0,
        "minDepth": null,
        "maxDepth": 10
    },
    {
        "id": "45447228-350c-44c2-80e0-b0ad12f9a0b9",
        "scriptName": "象牙塔美化-文字剧场美化（0106）@电波系",
        "findRegex": "/<ccd>\\s+([\\s\\S]*?)</ccd>/gi",
        "replaceString": "```html\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n<meta charset=\"UTF-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<title>仿 Apple 备忘录样式 (逻辑修复版)</title>\n<style>\n    /* 全局样式 */\n    body {\n        display: flex; justify-content: center; align-items: flex-start;\n        margin: 0; padding: 10px; box-sizing: border-box;\n        font-family: -apple-system, BlinkMacSystemFont, \"SF Pro Text\", \"Helvetica Neue\", sans-serif;\n    }\n    /* 窗口样式 */\n    .window {\n        width: 650px; max-width: 95%; background-color: #ffffff;\n        box-shadow: 0 6px 8px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.05);\n        border-radius: 12px; overflow: hidden; display: flex; flex-direction: column; color: #1d1d1f; \n    }\n    .title-bar {\n        display: flex; align-items: center; padding: 12px 18px; background-color: #fbfbfb;\n        border-bottom: 1px solid #e5e5e5; flex-shrink: 0;\n    }\n    .buttons { display: flex; gap: 8px; }\n    .dot { width: 12px; height: 12px; border-radius: 50%; }\n    .dot-red { background-color: #ff5f57; border: 1px solid #e0443e; }\n    .dot-yellow { background-color: #febc2e; border: 1px solid #dfa123; }\n    .dot-green { background-color: #28c840; border: 1px solid #1aab29; }\n    .toolbar-title { margin-left: auto; margin-right: auto; color: #86868b; font-size: 12px; font-weight: 500; padding-right: 50px; }\n    \n    /* 内容区域 */\n    .content {\n        padding: 10px 50px 10px; font-size: 15px; line-height: 1.7;\n        font-family: \"PingFang SC\", \"Hiragino Sans GB\", \"Microsoft YaHei\", sans-serif;\n    }\n\n    /* --- 动画 --- */\n    @keyframes fadeInUp {\n        from { opacity: 0; transform: translateY(15px); }\n        to { opacity: 1; transform: translateY(0); }\n    }\n    .line-wrapper {\n        opacity: 0;\n    }\n    .line-wrapper.animate-in {\n        animation: fadeInUp 0.5s ease-out forwards;\n    }\n    \n    .content strong { font-weight: 600; color: #000; }\n    .content s { text-decoration: line-through; color: #86868b; }\n    .content em { font-style: italic; color: #4a4949; }\n    .content .highlight { font-weight: 500; }\n\n    .content code {\n        background-color: #f3f4f6; color: #4b5563; padding: 2px 6px;\n        border-radius: 4px; font-family: \"SF Mono\", Menlo, Monaco, Consolas, \"Courier New\", monospace;\n        font-size: 0.9em;\n    }\n\n    .content .quote-center {\n        text-align: center; background-color: #f0f0f0a0; padding: 15px 20px;\n        margin: 10px 0; border-radius: 8px; color: #555; border: 1px solid #eee;\n    }\n\n    .content .quote-block {\n        text-align: left; \n        padding: 8px 15px;\n        border-left: 3px solid #d1d5db; color: #4b5563;\n        padding-left: calc(15px + var(--nest-level, 0) * 20px); \n    }\n\n    .content h1, .content h2, .content h3 {\n        margin: 10px 0 10px 0; padding-bottom: 5px; line-height: 1.5; font-weight: 600;\n        color: #000000; border-bottom: 1px solid #f0f0f0;\n    }\n    .content h1 { font-size: 1.3em; text-align: center;} \n    .content h2 { font-size: 1.2em; } \n    .content h3 { font-size: 1.1em; }\n\n    .content .highlight-block {\n        text-align: justify; background-color: #fff0fb; padding: 15px 20px;\n        margin: 10px 0; border-radius: 8px; color: #75435f;\n        border-left: 4px solid #e774b2;\n    }\n\n    .content ul {\n        list-style: none; \n        padding-left: 20px;\n        margin: 10px 0;\n    }\n    .content li {\n        position: relative;\n        padding-left: 10px; \n    }\n    .content li::before {\n        content: '•'; \n        color: #3b82f6; \n        font-weight: bold;\n        position: absolute;\n        left: -15px;\n    }\n\n    .content table {\n        width: 100%;\n        border-collapse: collapse;\n        margin: 20px 0;\n        font-size: 0.95em;\n    }\n    .content th, .content td {\n        padding: 10px 12px;\n        text-align: left;\n    }\n    .content th {\n        font-weight: 600;\n        border-bottom: 1px solid #e5e7eb;\n    }\n    .content tbody tr:nth-child(even) {\n        background-color: #f9fafb; \n    }\n\n    .content hr {\n        border: none; border-top: 1px solid #e5e7eb; margin: 25px 0;\n    }\n\n    .content .empty-line { height: 20px; }\n\n    @media (max-width: 420px) {\n        .content { padding: 10px 30px 10px; font-size: 14px; }\n    }\n</style>\n</head>\n<body>\n\n<div class=\"window\">\n    <div class=\"title-bar\">\n        <div class=\"buttons\">\n            <span class=\"dot dot-red\"></span>\n            <span class=\"dot dot-yellow\"></span>\n            <span class=\"dot dot-green\"></span>\n        </div>\n        <span class=\"toolbar-title\" id=\"current-time\"></span>\n    </div>\n    \n    <div id=\"raw-data\" style=\"display:none;\">\n<start>\n$1\n</end>\n    </div>\n\n    <div class=\"content\" id=\"animated-content\"></div>\n</div>\n\n<script>\ndocument.addEventListener('DOMContentLoaded', function() {\n    // --- Setup ---\n    const animatedContent = document.getElementById('animated-content');\n    const now = new Date();\n    document.getElementById('current-time').textContent = `编辑于 今天 ${now.getHours()}:${String(now.getMinutes()).padStart(2, '0')}`;\n    const highlightColors = ['#FF3B30', '#FF9500', '#007AFF', '#5856D6', '#5AC8FA', '#FF2D55'];\n\n    // --- Inline Parsing Functions ---\n    const applyCode = (t) => t.replace(/`(.*?)`/g, (m, c) => `<code>${c}</code>`);\n    const applyBold = (t) => t.replace(/\\*\\*(.*?)\\*\\*/g, (m, c) => `<strong>${c}</strong>`);\n    const applyStrikethrough = (t) => t.replace(/\\~\\~(.*?)\\~\\~|<del>(.*?)<\\/del>/g, (m, c1, c2) => `<s>${c1 || c2}</s>`);\n    const applyItalic = (t) => t.replace(/\\*(.*?)\\*/g, (m, c) => `<em>${c}</em>`);\n    const applyHighlight = (t) => t.replace(/(\\[.*?\\]|\\(.*?\\)|\".*?\"|“.*?”)/g, (m) => {\n        const randomColor = highlightColors[Math.floor(Math.random() * highlightColors.length)];\n        return `<span class=\"highlight\" style=\"color: ${randomColor};\">${m}</span>`;\n    });\n\n    function parseInlineMarkdown(text) {\n        return applyHighlight(applyItalic(applyStrikethrough(applyBold(applyCode(text)))));\n    }\n\n    // --- Main Recursive Parser ---\n    function parseContent(lines) {\n        const htmlChunks = [];\n        let i = 0;\n        \n        const isTableSeparator = (line) => /^\\|(?:\\s*:?-+:?\\s*\\|)+$/.test(line);\n\n        while (i < lines.length) {\n            const trimmedLine = lines[i].trim();\n            \n            if (i + 1 < lines.length && isTableSeparator(lines[i + 1].trim())) {\n                const tableData = { headers: [], alignments: [], rows: [] };\n                tableData.alignments = lines[i + 1].trim().split('|').slice(1, -1).map(s => {\n                    const align = s.trim();\n                    if (align.startsWith(':') && align.endsWith(':')) return 'center';\n                    if (align.endsWith(':')) return 'right';\n                    return 'left';\n                });\n                tableData.headers = lines[i].trim().split('|').slice(1, -1).map(s => s.trim());\n                let rowIndex = i + 2;\n                while (rowIndex < lines.length && lines[rowIndex].trim().startsWith('|')) {\n                    tableData.rows.push(lines[rowIndex].trim().split('|').slice(1, -1).map(s => s.trim()));\n                    rowIndex++;\n                }\n                let tableHTML = '<table><thead><tr>';\n                tableData.headers.forEach((h, idx) => { tableHTML += `<th style=\"text-align: ${tableData.alignments[idx]};\">${parseInlineMarkdown(h)}</th>`; });\n                tableHTML += '</tr></thead><tbody>';\n                tableData.rows.forEach(r => {\n                    tableHTML += '<tr>';\n                    r.forEach((c, idx) => { tableHTML += `<td style=\"text-align: ${tableData.alignments[idx]};\">${parseInlineMarkdown(c)}</td>`; });\n                    tableHTML += '</tr>';\n                });\n                tableHTML += '</tbody></table>';\n                htmlChunks.push(tableHTML);\n                i = rowIndex;\n                \n            } else if (trimmedLine.startsWith('>')) {\n                const quoteGroup = [];\n                let currentIndex = i;\n                while (currentIndex < lines.length && lines[currentIndex].trim().startsWith('>')) {\n                    quoteGroup.push(lines[currentIndex].trim());\n                    currentIndex++;\n                }\n                \n                const nestedLines = quoteGroup.map(line => line.substring(line.indexOf('>') + 1));\n                const innerHtml = parseContent(nestedLines).join('');\n                \n                htmlChunks.push(`<div class=\"quote-center\">${innerHtml}</div>`);\n                i = currentIndex;\n\n            } else if (trimmedLine.startsWith('||')) {\n                // --- 核心修复：||xxx 语法，支持合并、嵌套和清理 ---\n                const groupedRawInnerLines = [];\n                let currentIndex = i;\n\n                // 1. 循环吞并所有连续以 || 开头的行\n                while (currentIndex < lines.length && lines[currentIndex].trim().startsWith('||')) {\n                    const currentBlockLine = lines[currentIndex].trim();\n                    \n                    // 2. 提取 || 后面的内容\n                    let rawInnerLine = currentBlockLine.substring(2);\n                    \n                    // 3. 清理该行内所有可能存在的 || 标记\n                    let cleanedInnerLine = rawInnerLine.replace(/\\|\\|/g, '');\n\n                    // 4. 将纯净的内容行加入数组\n                    groupedRawInnerLines.push(cleanedInnerLine);\n                    currentIndex++;\n                }\n\n                // 5. 递归调用 parseContent 处理收集到的所有内部行\n                const parsedInnerHtml = parseContent(groupedRawInnerLines).join('');\n                \n                // 6. 将最终结果包裹在单个高亮块中\n                htmlChunks.push(`<div class=\"highlight-block\">${parsedInnerHtml}</div>`);\n                i = currentIndex;\n\n            } else if (trimmedLine.startsWith('* ')) {\n                const listItems = [];\n                let currentIndex = i;\n                while (currentIndex < lines.length && lines[currentIndex].trim().startsWith('* ')) {\n                    listItems.push(lines[currentIndex].trim().substring(2));\n                    currentIndex++;\n                }\n                htmlChunks.push(`<ul>${listItems.map(item => `<li>${parseInlineMarkdown(item)}</li>`).join('')}</ul>`);\n                i = currentIndex;\n\n            } else if (/^---+\\s*$/.test(trimmedLine)) {\n                htmlChunks.push('<hr>');\n                i++;\n\n            } else {\n                if (trimmedLine === '') {\n                    // 【关键改动 #2】只有在前一个元素不是空行 div 的情况下，才添加新的空行 div\n                    if (htmlChunks.length === 0 || htmlChunks[htmlChunks.length - 1] !== '<div class=\"empty-line\"></div>') {\n                        htmlChunks.push('<div class=\"empty-line\"></div>');\n                    }\n                } else {\n                    const headingMatch = trimmedLine.match(/^(\\#{1,3})\\s(.*)/);\n                    if (headingMatch) {\n                        const level = headingMatch[1].length;\n                        const content = headingMatch[2];\n                        const randomColor = highlightColors[Math.floor(Math.random() * highlightColors.length)];\n                        htmlChunks.push(`<h${level} style=\"color: ${randomColor};\">${parseInlineMarkdown(content)}</h${level}>`);\n                    } else {\n                        htmlChunks.push(`<div>${parseInlineMarkdown(trimmedLine)}</div>`);\n                    }\n                }\n                i++;\n            }\n        }\n        return htmlChunks;\n    }\n\n    // --- Initial Call ---\n    let rawContent = '';\n    const rawText = document.getElementById('raw-data').textContent;\n    const startEndMatch = rawText.match(/<start>([\\s\\S]*?)<end>/);\n    rawContent = (startEndMatch && startEndMatch[1]) ? startEndMatch[1].trim() : rawText;\n\n    const initialLines = rawContent.split('\\n');\n    const finalHtmlBlocks = parseContent(initialLines);\n\n    // --- Animate Final Blocks ---\n    finalHtmlBlocks.forEach((htmlBlock, index) => {\n        const wrapper = document.createElement('div');\n        wrapper.className = 'line-wrapper';\n        wrapper.innerHTML = htmlBlock;\n        animatedContent.appendChild(wrapper);\n\n        setTimeout(() => {\n            wrapper.classList.add('animate-in');\n        }, index * 100);\n    });\n});\n</script>\n</body>\n</html>\n```",
        "trimStrings": [],
        "placement": [
            2
        ],
        "disabled": false,
        "markdownOnly": true,
        "promptOnly": false,
        "runOnEdit": true,
        "substituteRegex": 0,
        "minDepth": null,
        "maxDepth": 10
    },
    {
        "id": "58182132-e0fd-4bbd-ba62-247e074911ed",
        "scriptName": "象牙塔美化-摘要美化（0117）@电波系",
        "findRegex": "/<meow_FM>\\s+([\\s\\S]*?)</meow_FM>/gi",
        "replaceString": "```html\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n    <title>象牙塔美化 - 容器粒子版 @电波系</title>\n    <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n    <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n    <link href=\"https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;700&display=swap\" rel=\"stylesheet\">\n    <!-- 引入 FontAwesome -->\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <style>\n        :root {\n            --font-main: \"Noto Serif SC\", \"Source Han Serif CN\", serif;\n            --transition: 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);\n        }\n\n        /* --- 浅色模式 (Light Mode) --- */\n        body.theme-light {\n            /* body 背景透明 */\n            --bg-card: rgba(250, 248, 245, 0.85); \n            --border-color: rgba(180, 160, 130, 0.4);\n            --text-main: #4a443a;\n            --text-sub: #7a7060;\n            --accent: #9e8b6e;\n            --accent-bg: rgba(158, 139, 110, 0.12);\n            --module-bg: rgba(255, 255, 255, 0.6); \n            --nsfw-color: #c05050;\n            --nsfw-bg: rgba(192, 80, 80, 0.08);\n            --shadow: 0 6px 8px rgba(85, 80, 70, 0.15);\n            --footer-border: linear-gradient(90deg, transparent, rgba(180, 160, 130, 0.5), transparent);\n            \n            --particle-color: rgba(158, 139, 110, 0.5); /* 金沙 */\n        }\n\n        /* --- 深色模式 (Dark Mode) --- */\n        body.theme-dark {\n            /* body 背景透明 */\n            --bg-card: rgba(40, 42, 46, 0.96);\n            --border-color: rgba(188, 165, 127, 0.25);\n            --text-main: #e2e8f0;\n            --text-sub: #94a3b8;\n            --accent: #cba876;\n            --accent-bg: rgba(176, 160, 128, 0.15);\n            --module-bg: rgba(0, 0, 0, 0.3);\n            --nsfw-color: #d07070;\n            --nsfw-bg: rgba(208, 112, 112, 0.15);\n            --shadow: 0 6px 8px rgba(0, 0, 0, 0.15);\n            --footer-border: linear-gradient(90deg, transparent, rgba(188, 165, 127, 0.3), transparent);\n            \n            --particle-color: rgba(203, 168, 118, 0.4); /* 星尘 */\n        }\n\n        /* 全局重置 */\n        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }\n        \n        body {\n            margin: 0;\n            padding: 10px;\n            font-family: var(--font-main);\n            background: transparent; /* 去掉背景色 */\n            color: var(--text-main);\n            transition: color var(--transition);\n            line-height: 1.6;\n        }\n\n        /* 主容器 */\n        .meow-fm-container {\n            max-width: 550px;\n            width: 100%;\n            margin: 0 auto;\n            background: var(--bg-card);\n            border-radius: 16px;\n            border: 1px solid var(--border-color);\n            box-shadow: var(--shadow);\n            backdrop-filter: blur(10px);\n            -webkit-backdrop-filter: blur(10px);\n            overflow: hidden; /* 裁剪超出容器的粒子 */\n            position: relative; /* 粒子定位基准 */\n            transition: all var(--transition);\n        }\n\n        /* 粒子画布：置于容器内部底层 */\n        #particle-canvas {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            z-index: 0; /* 在背景色之上，内容之下 */\n            pointer-events: none;\n        }\n\n        /* 确保内容在粒子之上 */\n        .relative-content {\n            position: relative;\n            z-index: 1;\n        }\n\n        /* Header */\n        .header-area {\n            padding: 30px 20px 20px;\n            text-align: center;\n            border-bottom: 1px solid var(--border-color);\n        }\n\n        .serial {\n            font-size: 1.3rem;\n            font-weight: 700; \n            color: var(--text-main);\n            margin-bottom: 12px;\n            letter-spacing: 1px;\n            display: inline-flex;\n            align-items: center;\n            justify-content: center;\n        }\n        \n        /* 四角星装饰 */\n        .serial::before, .serial::after {\n            content: '✦'; /* 使用字符，但在CSS中控制样式 */\n            font-family: var(--font-main); /* 保持字体一致，或用Arial等确保符号形状 */\n            font-size: 0.7em;\n            color: var(--accent);\n            margin: 0 12px;\n            opacity: 0.8;\n            transition: transform 0.5s ease;\n            display: inline-block;\n        }\n        .header-area:hover .serial::before { transform: rotate(90deg) scale(1.1); }\n        .header-area:hover .serial::after { transform: rotate(-90deg) scale(1.1); }\n\n        .meta-row {\n            display: flex;\n            flex-wrap: wrap;\n            justify-content: center;\n            align-items: center;\n            gap: 10px;\n            margin-bottom: 20px;\n        }\n\n        .time {\n            font-size: 0.9rem;\n            font-weight: 500;\n            color: var(--text-sub);\n            opacity: 0.9;\n        }\n\n        .nsfw-tag {\n            font-size: 0.75rem;\n            font-weight: 700;\n            color: var(--nsfw-color);\n            background: var(--nsfw-bg);\n            border: 1px solid var(--nsfw-color);\n            padding: 1px 6px;\n            border-radius: 4px;\n            display: none;\n            letter-spacing: 0.5px;\n        }\n\n        .expand-button {\n            display: inline-flex;\n            align-items: center;\n            justify-content: center;\n            width: 100%;\n            max-width: 180px;\n            padding: 8px 0;\n            background: var(--accent-bg);\n            color: var(--accent);\n            border: 1px solid var(--border-color);\n            border-radius: 50px;\n            font-size: 0.9rem;\n            font-weight: 600;\n            cursor: pointer;\n            transition: all 0.3s;\n            font-family: var(--font-main);\n            gap: 8px;\n        }\n        .expand-button:hover {\n            border-color: var(--accent);\n            background: var(--module-bg);\n        }\n        .expand-button:active { transform: scale(0.98); }\n\n        /* Content Area */\n        .meow-collapsible {\n            display: grid;\n            grid-template-rows: 0fr;\n            transition: grid-template-rows 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        .meow-collapsible.open { grid-template-rows: 1fr; }\n        \n        .content-wrapper { overflow: hidden; padding: 0 20px; }\n        .inner-padding {\n            padding: 25px 0 15px 0;\n            opacity: 0;\n            transform: translateY(10px);\n            transition: 0.4s;\n        }\n        .meow-collapsible.open .inner-padding { opacity: 1; transform: translateY(0); transition-delay: 0.15s; }\n\n        /* Modules */\n        .module {\n            margin-bottom: 25px;\n            padding: 20px 18px;\n            background: var(--module-bg);\n            border-radius: 8px;\n            border: 1px dashed var(--border-color);\n            position: relative;\n        }\n\n        .module-label {\n            position: absolute;\n            top: -10px;\n            left: 50%;\n            transform: translateX(-50%);\n            background: var(--accent);\n            color: #fff;\n            padding: 1px 10px;\n            font-size: 0.8rem;\n            font-weight: 700;\n            border-radius: 2px;\n            z-index: 2;\n            letter-spacing: 0.5px;\n        }\n\n        .module-content {\n            font-size: 0.98rem;\n            line-height: 1.7;\n            color: var(--text-main);\n            text-align: justify;\n        }\n        .scene .module-content { text-align: center; color: var(--accent); font-weight: 700; }\n        .module-content p { margin: 8px 0; }\n\n        /* Relation Cards */\n        .relation-content { display: flex; flex-direction: column; gap: 10px; }\n        .char-card {\n            background: rgba(255,255,255,0.05);\n            border-left: 3px solid var(--accent);\n            padding: 10px 15px;\n            border-radius: 0 4px 4px 0;\n            transition: background 0.3s;\n        }\n        .char-card:hover { background: var(--accent-bg); }\n        .char-head { font-weight: 700; color: var(--text-main); font-size: 1rem; margin-bottom: 4px; }\n        .char-body { font-size: 0.9rem; color: var(--text-sub); line-height: 1.5; }\n\n        /* Echoes */\n        .echo-item {\n            border-left: 2px solid var(--accent);\n            padding-left: 12px;\n            margin-bottom: 12px;\n        }\n        .echo-quote { font-style: italic; color: var(--text-main); display: block; margin-bottom: 4px; }\n        .echo-speaker { display: block; text-align: right; font-size: 0.85rem; font-weight: 700; color: var(--accent); }\n\n        /* Details Boxes */\n        .details-box {\n            border: 1px solid var(--border-color);\n            border-radius: 6px;\n            margin-bottom: 15px;\n            background: var(--module-bg);\n            overflow: hidden;\n            transition: border-color 0.3s;\n        }\n        .details-box:hover { border-color: var(--accent); }\n        \n        .details-box summary {\n            list-style: none;\n            padding: 12px 15px;\n            font-weight: 600;\n            font-size: 0.9rem;\n            cursor: pointer;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            color: var(--text-sub);\n            transition: 0.3s;\n        }\n        .details-box summary i { width: 24px; text-align: center; margin-right: 5px; color: var(--accent); }\n        .details-box summary::-webkit-details-marker { display: none; }\n        .details-box summary::after { \n            font-family: \"Font Awesome 6 Free\"; font-weight: 900;\n            content: '\\f107'; /* angle-down */\n            transition: transform 0.3s;\n        }\n        .details-box[open] summary { background: var(--accent-bg); color: var(--text-main); }\n        .details-box[open] summary::after { transform: rotate(180deg); }\n\n        .details-content {\n            padding: 15px;\n            font-size: 0.9rem;\n            line-height: 1.6;\n            border-top: 1px solid var(--border-color);\n            color: var(--text-sub);\n        }\n        .details-content .title { font-weight: 700; color: var(--text-main); margin-top: 8px; display: block; }\n        .details-content .item { margin-left: 5px; display: block; position: relative; padding-left: 14px; }\n        .details-content .item::before { \n            content: '·'; \n            position: absolute; left: 0; \n            font-weight: bold; color: var(--accent);\n        }\n\n        /* Footer */\n        .meow-footer {\n            text-align: center;\n            padding: 15px 20px 25px;\n            position: relative;\n            z-index: 2; /* 确保在粒子上 */\n        }\n        /* 顶部装饰线 */\n        .meow-footer::before {\n            content: '';\n            display: block;\n            width: 70%;\n            height: 1px;\n            margin: 0 auto 15px;\n            background: var(--footer-border);\n        }\n\n        .footer-deco { \n            color: var(--accent); \n            opacity: 0.6; \n            font-size: 0.85rem; \n            margin-bottom: 8px;\n            display: block; \n        }\n\n        .footer-text { \n            margin: 0 0 15px 0; \n            font-size: 1.1em; \n            font-family: cursive, serif;\n            color: var(--accent); \n        }\n\n        .meow-footer span {\n            color: var(--accent);\n        }\n\n        /* --- 新款胶囊样式工具栏 --- */\n        .theme-capsule {\n            display: inline-flex;\n            align-items: center;\n            justify-content: center;\n            border: 1px solid var(--border-color);\n            border-radius: 50px;\n            padding: 4px;\n            gap: 4px;\n            background: rgba(0, 0, 0, 0.05);\n            transition: all 0.3s;\n        }\n\n        body.theme-dark .theme-capsule {\n            background: rgba(255, 255, 255, 0.02);\n        }\n\n        .theme-capsule:hover {\n            border-color: var(--accent);\n        }\n\n        /* 按钮单体 */\n        .capsule-btn {\n            cursor: pointer;\n            font-size: 1rem;\n            color: var(--text-sub);\n            width: 36px;\n            height: 32px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            border-radius: 20px;\n            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n\n        .capsule-btn:hover {\n            color: var(--accent);\n            background: rgba(128, 128, 128, 0.08);\n        }\n\n        /* 激活状态 */\n        .capsule-btn.active {\n            color: var(--accent);\n            text-shadow: 0 0 10px var(--accent-bg);\n            transform: scale(1.05);\n        }\n\n        /* 分割线 */\n        .capsule-divider {\n            width: 1px;\n            height: 14px;\n            background-color: var(--border-color);\n            opacity: 0.6;\n        }\n\n    </style>\n</head>\n<body class=\"theme-light\">\n\n    <div class=\"raw-data\" style=\"display: none;\">$1</div>\n\n    <!-- 粒子特效 canvas 现已移入容器内 -->\n    <div class=\"meow-fm-container\">\n        <!-- 粒子画布 -->\n        <canvas id=\"particle-canvas\"></canvas>\n        \n        <!-- Header -->\n        <div class=\"relative-content\">\n            <header class=\"header-area\" id=\"toggle-header\">\n                <div class=\"serial\">Loading...</div>\n                <div class=\"meta-row\">\n                    <div class=\"time\"></div>\n                    <div class=\"nsfw-tag\"></div>\n                </div>\n                <button class=\"expand-button\" id=\"expand-btn-text\">\n                    <i class=\"fa-solid fa-key\"></i>\n                    <span>叩响塔门…</span>\n                </button>\n            </header>\n\n            <div class=\"meow-collapsible\" id=\"collapsible-content\">\n                <div class=\"content-wrapper\">\n                    <div class=\"inner-padding\">\n                        <!-- Scenario -->\n                        <div class=\"module scene\" id=\"mod-scene\">\n                            <span class=\"module-label\">Scenario</span>\n                            <div class=\"module-content scene-content\"></div>\n                        </div>\n                        <!-- Plot -->\n                        <div class=\"module plot\" id=\"mod-plot\">\n                            <span class=\"module-label\">Plot</span>\n                            <div class=\"module-content plot-content\"></div>\n                        </div>\n                        <!-- Relation -->\n                        <div class=\"module relation\" id=\"mod-relation\" style=\"display:none;\">\n                            <span class=\"module-label\">Relation</span>\n                            <div class=\"module-content relation-content\"></div>\n                        </div>\n                        <!-- Memory -->\n                        <div class=\"module echoes\" id=\"mod-echoes\" style=\"display:none;\">\n                            <span class=\"module-label\">Memory</span>\n                            <div class=\"module-content echoes-content\"></div>\n                        </div>\n\n                        <!-- Archived -->\n                        <details class=\"details-box\" id=\"mod-archived\" style=\"display:none;\">\n                            <summary>\n                                <span><i class=\"fa-solid fa-box-archive\"></i> 封存回响</span>\n                            </summary>\n                            <div class=\"details-content archived-content\"></div>\n                        </details>\n                        <!-- Enigma -->\n                        <details class=\"details-box\" id=\"mod-enigma\" style=\"display:none;\">\n                            <summary>\n                                <span><i class=\"fa-solid fa-file-shield\"></i> 绝密档案</span>\n                            </summary>\n                            <div class=\"details-content enigma-content\"></div>\n                        </details>\n                        <!-- Seeds -->\n                        <details class=\"details-box\" id=\"mod-seeds\" style=\"display:none;\">\n                            <summary>\n                                <span><i class=\"fa-solid fa-seedling\"></i> 未来种子</span>\n                            </summary>\n                            <div class=\"details-content seeds-content\"></div>\n                        </details>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Footer -->\n            <footer class=\"meow-footer\">\n                <!-- 极简胶囊控制器 -->\n                <div class=\"theme-capsule\">\n                    <!-- 无穷大图标代表 Auto -->\n                    <div class=\"capsule-btn active\" id=\"autoBtn\" title=\"自动跟随时间 (6:00-18:00 日间)\">\n                        <i class=\"fa-solid fa-infinity\"></i>\n                    </div>\n                    <!-- 分隔线 -->\n                    <div class=\"capsule-divider\"></div>\n                    <!-- 日夜图标 -->\n                    <div class=\"capsule-btn\" id=\"themeToggleBtn\" title=\"切换日夜模式\">\n                        <span id=\"themeIcon\"><i class=\"fa-solid fa-sun\"></i></span>\n                    </div>\n                </div>\n\n                <div class=\"footer-deco\">\n                    <i class=\"fa-solid fa-fleur-de-lis\"></i>\n                </div>\n                \n                <div class=\"footer-light\">\n                    <span>· ─────── ⚜ ─────── ·</span>\n                    <p class=\"footer-text\">𝓔𝓬𝓱𝓸𝓲𝓷𝓰 𝓘𝓿𝓸𝓻𝔂 𝓣𝓸𝔀𝓮𝓻</p>\n                </div>\n                <div class=\"footer-dark\" style=\"display:none;\">\n                    <span>· ─────── ⚜ ─────── ·</span>\n                    <p class=\"footer-text\">𝕾𝖎𝖑𝖊𝖓𝖙 𝕾𝖈𝖗𝖎𝖕𝖙𝖔𝖗𝖎𝖚𝖒</p>\n                </div>\n            </footer>\n        </div>\n    </div>\n\n    <script>\n        document.addEventListener('DOMContentLoaded', function() {\n            // ================= 1. 粒子系统 (限制在容器内) =================\n            const canvas = document.getElementById('particle-canvas');\n            const container = document.querySelector('.meow-fm-container');\n            const ctx = canvas.getContext('2d');\n            let particles = [];\n            let animationFrameId;\n            let width, height;\n\n            function resizeCanvas() {\n                width = container.offsetWidth;\n                height = container.offsetHeight;\n                canvas.width = width;\n                canvas.height = height;\n            }\n\n            const resizeObserver = new ResizeObserver(() => {\n                resizeCanvas();\n            });\n            resizeObserver.observe(container);\n            resizeCanvas();\n\n            class Particle {\n                constructor() {\n                    this.reset(true);\n                }\n\n                reset(initial = false) {\n                    this.x = Math.random() * width;\n                    this.y = initial ? Math.random() * height : height + 5;\n                    this.size = Math.random() * 2 + 0.5; \n                    this.speedY = Math.random() * 0.4 + 0.1; \n                    this.speedX = Math.random() * 0.4 - 0.2; \n                    this.opacity = Math.random() * 0.5 + 0.1;\n                    this.fadeSpeed = Math.random() * 0.005 + 0.002;\n                    this.fadingOut = Math.random() > 0.5;\n                }\n\n                update() {\n                    this.y -= this.speedY;\n                    this.x += this.speedX;\n\n                    if (this.fadingOut) {\n                        this.opacity -= this.fadeSpeed;\n                        if (this.opacity <= 0.05) this.fadingOut = false;\n                    } else {\n                        this.opacity += this.fadeSpeed;\n                        if (this.opacity >= 0.6) this.fadingOut = true;\n                    }\n\n                    if (this.y < -10 || this.x < -10 || this.x > width + 10) {\n                        this.reset();\n                    }\n                }\n\n                draw() {\n                    const style = getComputedStyle(document.body);\n                    const colorStr = style.getPropertyValue('--particle-color').trim();\n                    \n                    ctx.fillStyle = colorStr;\n                    ctx.globalAlpha = this.opacity;\n                    ctx.beginPath();\n                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);\n                    ctx.fill();\n                    ctx.globalAlpha = 1.0;\n                }\n            }\n\n            function initParticles() {\n                particles = [];\n                const count = Math.floor(container.offsetWidth / 8); \n                for (let i = 0; i < count; i++) {\n                    particles.push(new Particle());\n                }\n            }\n\n            function animateParticles() {\n                ctx.clearRect(0, 0, width, height);\n                particles.forEach(p => {\n                    p.update();\n                    p.draw();\n                });\n                animationFrameId = requestAnimationFrame(animateParticles);\n            }\n\n            setTimeout(() => {\n                resizeCanvas();\n                initParticles();\n                animateParticles();\n            }, 100);\n\n\n            // ================= 2. 内容解析逻辑 =================\n            const regex = /serial[:：]\\s*([^\\n]*)\\s*time[:：]\\s*([^\\n]*)(?:\\s*NSFW[:：]\\s*([\\s\\S]*?))?\\s*scene[:：]\\s*([\\s\\S]*?)\\s*plot[:：]\\s*([\\s\\S]*?)(?:\\s*relation[:：]\\s*([\\s\\S]*?))?(?:\\s*echoes[:：]\\s*([\\s\\S]*?))?(?:\\s*archived[:：]\\s*([\\s\\S]*?))?(?:\\s*enigma[:：]\\s*([\\s\\S]*?))?(?:\\s*seeds[:：]\\s*([\\s\\S]*))?$/i;\n\n            function parseAndRender() {\n                const rawDataElement = document.querySelector('.raw-data');\n                if (!rawDataElement || !rawDataElement.textContent.trim()) return;\n\n                const rawText = rawDataElement.textContent.trim();\n                const match = rawText.match(regex);\n\n                if (match) {\n                    const [_, serial, time, nsfw, scene, plot, relation, echoes, archived, enigma, seeds] = match;\n\n                    document.querySelector('.serial').textContent = serial.trim();\n                    document.querySelector('.time').textContent = time.trim();\n                    \n                    const nsfwTag = document.querySelector('.nsfw-tag');\n                    if (nsfw && nsfw.trim() && nsfw.trim() !== '0' && nsfw.trim().toLowerCase() !== 'false') {\n                        nsfwTag.textContent = \"NSFW: \" + nsfw.trim();\n                        nsfwTag.style.display = 'block';\n                    } else { \n                        nsfwTag.style.display = 'none'; \n                    }\n\n                    document.querySelector('.plot-content').innerHTML = plot.trim().split('\\n').map(l=>`<p>${l}</p>`).join('');\n                    document.querySelector('.scene-content').innerHTML = scene.trim().split('\\n').map(l=>`<p>${l}</p>`).join('');\n\n                    const relationMod = document.getElementById('mod-relation');\n                    if (relation && relation.trim()) {\n                        relationMod.style.display = 'block';\n                        const container = relationMod.querySelector('.relation-content');\n                        container.innerHTML = '';\n                        relation.trim().split('◈').forEach(chunk => {\n                            if (!chunk.trim()) return;\n                            const card = document.createElement('div');\n                            card.className = 'char-card';\n                            const lines = chunk.trim().split('\\n');\n                            card.innerHTML = `<div class=\"char-head\">${lines[0].trim()}</div><div class=\"char-body\">${lines.slice(1).join('<br>')}</div>`;\n                            container.appendChild(card);\n                        });\n                    } else { relationMod.style.display = 'none'; }\n\n                    const echoesMod = document.getElementById('mod-echoes');\n                    if (echoes && echoes.trim()) {\n                        const echoLines = echoes.trim().split('\\n').filter(line => line.trim().startsWith('-'));\n                        if(echoLines.length > 0) {\n                            echoesMod.style.display = 'block';\n                            const container = echoesMod.querySelector('.echoes-content');\n                            container.innerHTML = '';\n                            echoLines.forEach(line => {\n                                const content = line.substring(1).trim();\n                                const colonIndex = content.search(/[:：]/);\n                                if (colonIndex > 0) {\n                                    const speaker = content.substring(0, colonIndex).trim();\n                                    const quote = content.substring(colonIndex + 1).trim();\n                                    const item = document.createElement('div');\n                                    item.className = 'echo-item';\n                                    item.innerHTML = `<span class=\"echo-quote\">“${quote}”</span><span class=\"echo-speaker\">— ${speaker}</span>`;\n                                    container.appendChild(item);\n                                }\n                            });\n                        } else { echoesMod.style.display = 'none'; }\n                    } else { echoesMod.style.display = 'none'; }\n\n                    const setupDetailsModule = (moduleKey, content) => {\n                        const mod = document.getElementById(`mod-${moduleKey}`);\n                        if (content && content.trim()) {\n                            mod.style.display = 'block';\n                            const container = mod.querySelector(`.${moduleKey}-content`);\n                            container.innerHTML = '';\n                            content.trim().split('\\n').forEach(line => {\n                                const p = document.createElement('div');\n                                const text = line.trim();\n                                if (text.startsWith('-') || text.startsWith('•')) {\n                                    p.className = 'item'; \n                                    p.textContent = text.substring(1).trim();\n                                } else {\n                                    p.className = 'title';\n                                    p.textContent = text;\n                                }\n                                container.appendChild(p);\n                            });\n                        } else { mod.style.display = 'none'; }\n                    };\n                    setupDetailsModule('archived', archived);\n                    setupDetailsModule('enigma', enigma);\n                    setupDetailsModule('seeds', seeds);\n                }\n            }\n\n            // ================= 3. 交互逻辑 =================\n            const header = document.getElementById('toggle-header');\n            const collapsibleContent = document.getElementById('collapsible-content');\n            const buttonText = document.querySelector('#expand-btn-text span');\n            const buttonIcon = document.querySelector('#expand-btn-text i');\n\n            header.addEventListener('click', (e) => {\n                if(e.target.closest('.meow-footer') || e.target.closest('.theme-capsule')) return;\n                \n                collapsibleContent.classList.toggle('open');\n                const isOpen = collapsibleContent.classList.contains('open');\n                buttonText.textContent = isOpen ? '封存回响…' : '叩响塔门…';\n                buttonIcon.className = isOpen ? 'fa-solid fa-book-open' : 'fa-solid fa-key';\n            });\n\n            document.querySelectorAll('.details-box').forEach(el => {\n                el.addEventListener('click', (event) => event.stopPropagation());\n            });\n\n            // ================= 4. 主题控制 =================\n            const body = document.body;\n            const autoBtn = document.getElementById('autoBtn');\n            const themeBtn = document.getElementById('themeToggleBtn');\n            const themeIcon = document.getElementById('themeIcon');\n            const footerLight = document.querySelector('.footer-light');\n            const footerDark = document.querySelector('.footer-dark');\n            \n            let isAutoMode = true;\n            let isDarkMode = false;\n\n            function updateThemeUI() {\n                // UI 表现：如果是自动模式，高亮无穷大符号，否则淡化\n                if (isAutoMode) {\n                    autoBtn.classList.add('active');\n                    themeBtn.style.opacity = '0.6';\n                } else {\n                    autoBtn.classList.remove('active');\n                    themeBtn.style.opacity = '1';\n                }\n\n                themeIcon.innerHTML = isDarkMode \n                    ? '<i class=\"fa-solid fa-moon\"></i>' \n                    : '<i class=\"fa-solid fa-sun\"></i>';\n\n                if (isDarkMode) {\n                    body.classList.remove('theme-light');\n                    body.classList.add('theme-dark');\n                    footerLight.style.display = 'none';\n                    footerDark.style.display = 'block';\n                } else {\n                    body.classList.remove('theme-dark');\n                    body.classList.add('theme-light');\n                    footerLight.style.display = 'block';\n                    footerDark.style.display = 'none';\n                }\n            }\n\n            function checkTimeAndApplyAuto() {\n                if (!isAutoMode) return;\n                const hour = new Date().getHours();\n                const isDayTime = hour >= 6 && hour < 18;\n                isDarkMode = !isDayTime;\n                updateThemeUI();\n            }\n\n            // Init\n            checkTimeAndApplyAuto();\n            setInterval(checkTimeAndApplyAuto, 60000);\n\n            autoBtn.addEventListener('click', function(e) {\n                e.stopPropagation();\n                isAutoMode = !isAutoMode;\n                if(isAutoMode) checkTimeAndApplyAuto();\n                updateThemeUI();\n            });\n\n            themeBtn.addEventListener('click', function(e) {\n                e.stopPropagation();\n                if (isAutoMode) isAutoMode = false;\n                isDarkMode = !isDarkMode;\n                updateThemeUI();\n            });\n\n            parseAndRender();\n        });\n    </script>\n</body>\n</html>\n```",
        "trimStrings": [],
        "placement": [
            2
        ],
        "disabled": false,
        "markdownOnly": true,
        "promptOnly": false,
        "runOnEdit": true,
        "substituteRegex": 0,
        "minDepth": null,
        "maxDepth": 10
    },
    {
        "id": "f19bcb41-dea6-4e2c-a5ee-9ba199fa5cc2",
        "scriptName": "象牙塔美化-选项美化（0117）@电波系",
        "findRegex": "/<branches>\\s+([\\s\\S]*?)</branches>/gi",
        "replaceString": "```html\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n    <title>象牙塔美化-默认选项 (Auto Theme)</title>\n    <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n    <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n    <link href=\"https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600;700&family=Noto+Serif+SC:wght@400;500;700&display=swap\" rel=\"stylesheet\">\n    <style>\n        :root {\n            /* 通用变量 */\n            --font-en: \"Cormorant Garamond\", serif;\n            --font-cn: \"Noto Serif SC\", \"Source Han Serif CN\", serif;\n        }\n\n        /* --- 浅色模式 (Light Mode) --- */\n        body.theme-light {\n            --bg-card: rgba(252, 250, 246, 0.96);\n            --border-color: rgba(180, 160, 130, 0.4);\n            --text-main: #2b2b2b;\n            --text-sub: #757575;\n            --accent: #9e8b6e;\n            --btn-bg: #fff;\n            --selected-bg: rgba(158, 139, 110, 0.12);\n            --shadow: 0 4px 8px rgba(0,0,0,0.15);\n            --active-btn-text: #fff;\n        }\n\n        /* --- 深色模式 (Dark Mode) --- */\n        body.theme-dark {\n            --bg-card: rgba(40, 42, 46, 0.96);\n            --border-color: rgba(160, 140, 120, 0.25);\n            --text-main: #e0e0e0;\n            --text-sub: #909090;\n            --accent: #cba876;\n            --btn-bg: rgba(255,255,255,0.05);\n            --selected-bg: rgba(203, 168, 118, 0.15);\n            --shadow: 0 4px 8px rgba(0,0,0,0.15);\n            --active-btn-text: #2b2b2b;\n        }\n\n        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }\n\n        body {\n            margin: 0; padding: 10px;\n            font-family: var(--font-cn);\n            background: transparent;\n            display: flex;\n            align-items: flex-start;\n            justify-content: center;\n            color: var(--text-main);\n            transition: color 0.4s ease;\n        }\n\n        /* 主面板 */\n        .options-panel {\n            width: 100%;\n            max-width: 550px;\n            background: var(--bg-card);\n            backdrop-filter: blur(20px);\n            -webkit-backdrop-filter: blur(20px);\n            border-radius: 16px;\n            border: 1px solid var(--border-color);\n            box-shadow: var(--shadow);\n            \n            display: flex;\n            flex-direction: column;\n            overflow: hidden;\n            \n            opacity: 0;\n            animation: slideUp 0.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;\n            transition: transform 0.3s ease, background-color 0.4s ease, border-color 0.4s ease;\n        }\n        @keyframes slideUp { to { opacity: 1; transform: translateY(0); } }\n\n        /* --- 标题区域 --- */\n        .panel-header {\n            padding: 20px;\n            text-align: center;\n            cursor: pointer;\n            user-select: none;\n            border-bottom: 1px solid transparent;\n            transition: all 0.3s ease;\n            position: relative;\n        }\n        .panel-header:active { background-color: rgba(0,0,0,0.02); }\n        .options-panel.expanded .panel-header { border-bottom-color: var(--border-color); }\n\n        .panel-title {\n            font-family: var(--font-en);\n            font-size: 1.4rem;\n            font-weight: 700;\n            color: var(--text-main);\n            margin: 0;\n            line-height: 1.1;\n            display: inline-block;\n        }\n\n        .panel-title::before, .panel-title:after {\n            content: '✦';\n            font-size: 0.6em;\n            color: var(--accent);\n            margin: 0 10px;\n            vertical-align: middle;\n            opacity: 0.7;\n        }\n\n        .panel-subtitle {\n            margin-top: 6px;\n            font-size: 0.8rem;\n            color: var(--accent);\n            text-transform: uppercase;\n            letter-spacing: 2px;\n            font-weight: 700;\n            opacity: 0.8;\n            font-family: var(--font-en);\n        }\n\n        /* SVG 箭头 */\n        .toggle-icon {\n            position: absolute;\n            right: 20px;\n            top: 50%;\n            transform: translateY(-50%);\n            width: 32px;\n            height: 32px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            border-radius: 50%;\n            transition: background 0.3s ease;\n            opacity: 0.7;\n        }\n        .toggle-icon svg {\n            width: 16px;\n            height: 16px;\n            fill: none;\n            stroke: var(--accent);\n            stroke-width: 2.5;\n            stroke-linecap: round;\n            stroke-linejoin: round;\n            transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);\n        }\n        .options-panel.expanded .toggle-icon svg { transform: rotate(180deg); }\n        .panel-header:hover .toggle-icon { background: rgba(158, 139, 110, 0.1); opacity: 1; }\n\n        /* --- 折叠包装 --- */\n        .collapsible-wrapper {\n            display: grid;\n            grid-template-rows: 0fr;\n            transition: grid-template-rows 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        .options-panel.expanded .collapsible-wrapper { grid-template-rows: 1fr; }\n        .collapsible-content { overflow: hidden; }\n\n        /* --- 列表区 --- */\n        .options-list {\n            padding: 20px 20px 10px 20px;\n            display: flex;\n            flex-direction: column;\n            gap: 12px;\n        }\n\n        .option-button {\n            position: relative;\n            width: 100%;\n            padding: 16px 15px 16px 45px;\n            text-align: left;\n            font-family: var(--font-cn);\n            font-size: 1.05rem;\n            line-height: 1.6;\n            color: var(--text-main);\n            background: var(--btn-bg);\n            border: 1px solid var(--border-color);\n            border-radius: 10px;\n            cursor: pointer;\n            transition: all 0.2s ease;\n            white-space: normal; \n            word-break: break-word;\n        }\n\n        .option-button::before {\n            content: \"✧\";\n            position: absolute;\n            left: 16px;\n            top: 16px;\n            color: var(--accent);\n            font-size: 1.2rem;\n            opacity: 0.6;\n            transition: all 0.3s ease;\n        }\n\n        .option-button:hover {\n            border-color: var(--accent);\n            background: rgba(158, 139, 110, 0.05);\n        }\n\n        .option-button.chosen {\n            background: var(--selected-bg);\n            border-color: var(--accent);\n            font-weight: 700;\n        }\n        .option-button.chosen::before {\n            content: \"✦\";\n            opacity: 1;\n        }\n\n        /* --- 底部控制 --- */\n        .controls-area {\n            padding: 10px 20px 25px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            gap: 10px;\n        }\n\n        .mini-btn-group { \n            display: flex; \n            gap: 8px; /* 稍微紧凑一点以容纳更多按钮 */\n            align-items: center; \n            flex-shrink: 1;\n        }\n\n        .mini-btn {\n            background: transparent;\n            border: 1px solid var(--border-color); /* 显式边框 */\n            color: var(--text-sub);\n            padding: 4px 8px;\n            border-radius: 8px;\n            font-size: 0.85rem;\n            cursor: pointer;\n            font-family: var(--font-cn);\n            opacity: 0.8;\n            transition: all 0.2s;\n            white-space: nowrap;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n        .mini-btn:hover { \n            opacity: 1; \n            color: var(--accent); \n            border-color: var(--accent);\n        }\n        \n        /* 激活状态的按钮 (用于AUTO) */\n        .mini-btn.active {\n            background: var(--accent);\n            color: var(--active-btn-text);\n            border-color: var(--accent);\n            opacity: 1;\n            font-weight: bold;\n        }\n\n        .submit-btn {\n            background: var(--accent);\n            color: #fff;\n            border: none;\n            padding: 8px 20px;\n            border-radius: 50px;\n            font-size: 0.9rem;\n            font-weight: 600;\n            cursor: pointer;\n            box-shadow: 0 4px 10px rgba(158, 139, 110, 0.3);\n            transition: all 0.3s ease;\n            display: none;\n            opacity: 0;\n            transform: translateX(10px);\n            font-family: var(--font-cn);\n            white-space: nowrap;\n            flex-shrink: 0;\n        }\n        .submit-btn.show { display: block; opacity: 1; transform: translateX(0); }\n\n        /* Toast */\n        .toast {\n            position: fixed;\n            top: 50%; left: 50%;\n            transform: translate(-50%, -50%);\n            background: rgba(0,0,0,0.85);\n            color: #fff;\n            padding: 12px 24px;\n            border-radius: 30px;\n            font-size: 0.9rem;\n            opacity: 0;\n            pointer-events: none;\n            transition: 0.3s;\n            z-index: 100;\n            white-space: nowrap;\n        }\n        .toast.active { opacity: 1; }\n\n        /* --- 手机端专项适配 --- */\n        @media (max-width: 480px) {\n            .controls-area {\n                padding: 10px 15px 20px;\n            }\n            .mini-btn-group {\n                gap: 6px; \n            }\n            .mini-btn {\n                font-size: 0.75rem; \n                padding: 4px 6px;\n            }\n            .submit-btn {\n                padding: 6px 16px; \n                font-size: 0.85rem;\n            }\n            .option-button {\n                padding: 14px 12px 14px 40px;\n                font-size: 0.9rem;\n            }\n        }\n    </style>\n</head>\n<body class=\"theme-light\">\n    <div class=\"raw-data\" style=\"display: none;\">$1</div>\n\n    <div class=\"options-panel expanded\" id=\"panel\">\n        <div class=\"panel-header\" id=\"header-toggle\">\n            <div class=\"panel-title\">求索者抉择</div>\n            <div class=\"panel-subtitle\">MAKE YOUR DECISION</div>\n            <div class=\"toggle-icon\">\n                <svg viewBox=\"0 0 24 24\"><path d=\"M6 9l6 6 6-6\"/></svg>\n            </div>\n        </div>\n        \n        <div class=\"collapsible-wrapper\">\n            <div class=\"collapsible-content\">\n                <div class=\"options-list\" id=\"list-container\">\n                    <!-- 选项生成区 -->\n                </div>\n\n                <div class=\"controls-area\">\n                    <div class=\"mini-btn-group\">\n                        <!-- Auto 按钮 -->\n                        <button class=\"mini-btn active\" id=\"autoThemeBtn\" title=\"6:00-18:00 为日间\">◐ 自动</button>\n                        <!-- 手动切换按钮 -->\n                        <button class=\"mini-btn\" id=\"manualThemeBtn\" title=\"手动切换\">◐</button>\n                        <button class=\"mini-btn\" id=\"reset-btn\">↺ 重置</button>\n                        <button class=\"mini-btn\" id=\"clear-input-btn\">✕ 清空</button>\n                    </div>\n                    <button class=\"submit-btn\" id=\"submit-btn\">确认</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id=\"toast\" class=\"toast\"></div>\n\n    <script>\n        document.addEventListener('DOMContentLoaded', () => {\n            const listContainer = document.getElementById('list-container');\n            const submitBtn = document.getElementById('submit-btn');\n            const toastEl = document.getElementById('toast');\n            const panel = document.getElementById('panel');\n            const headerToggle = document.getElementById('header-toggle');\n            \n            // 按钮获取\n            const autoBtn = document.getElementById('autoThemeBtn');\n            const manualBtn = document.getElementById('manualThemeBtn');\n            const body = document.body;\n\n            // --- 状态管理 ---\n            let selectedOptions = new Set();\n            let isAutoMode = true;\n            let isDarkMode = false; // 当前显示状态\n\n            // --- 主题切换逻辑 ---\n            function updateThemeUI() {\n                // 更新按钮外观\n                if (isAutoMode) {\n                    autoBtn.classList.add('active');\n                    manualBtn.style.opacity = '0.5';\n                } else {\n                    autoBtn.classList.remove('active');\n                    manualBtn.style.opacity = '1';\n                }\n\n                // 更新图标\n                manualBtn.textContent = isDarkMode ? '✯ 夜间' : '☀ 日间';\n\n                // 更新 CSS 类\n                if (isDarkMode) {\n                    body.classList.remove('theme-light');\n                    body.classList.add('theme-dark');\n                } else {\n                    body.classList.remove('theme-dark');\n                    body.classList.add('theme-light');\n                }\n            }\n\n            function checkTimeAndApplyAuto() {\n                if (!isAutoMode) return;\n                const hour = new Date().getHours();\n                // 6:00 - 18:00 为日间\n                const isDayTime = hour >= 6 && hour < 18;\n                isDarkMode = !isDayTime;\n                updateThemeUI();\n            }\n\n            // 初始化主题\n            checkTimeAndApplyAuto();\n            setInterval(checkTimeAndApplyAuto, 60000); // 每分钟检查\n\n            // 事件：点击 AUTO\n            autoBtn.addEventListener('click', () => {\n                isAutoMode = true; \n                checkTimeAndApplyAuto();\n            });\n\n            // 事件：点击 手动切换\n            manualBtn.addEventListener('click', () => {\n                isAutoMode = false;\n                isDarkMode = !isDarkMode;\n                updateThemeUI();\n            });\n\n\n            // --- 选项解析与生成 ---\n            function populateOptionsFromRawData() {\n                const rawDataElement = document.querySelector('.raw-data');\n                if (!rawDataElement || !listContainer) return;\n\n                const rawText = rawDataElement.textContent.trim();\n                const options = rawText.split('\\n').filter(line => line.trim() !== '');\n                \n                listContainer.innerHTML = ''; \n\n                if (options.length === 0) {\n                    listContainer.innerHTML = '<div style=\"text-align:center;color:var(--text-sub);padding:20px;font-style:italic;\">暂无命运分支</div>';\n                    return;\n                }\n\n                options.forEach((optionText, index) => {\n                    const button = document.createElement('button');\n                    button.className = 'option-button';\n                    button.textContent = optionText.trim();\n                    button.style.animation = `slideUp 0.4s ease forwards ${index * 0.05}s`;\n                    button.style.opacity = '0';\n                    button.style.transform = 'translateY(10px)';\n\n                    button.addEventListener('click', function() {\n                        toggleSelection(this, optionText.trim());\n                    });\n                    \n                    listContainer.appendChild(button);\n                });\n            }\n\n            // --- 基础交互 ---\n            headerToggle.addEventListener('click', () => {\n                panel.classList.toggle('expanded');\n            });\n\n            function toggleSelection(btnElement, text) {\n                if (selectedOptions.has(text)) {\n                    selectedOptions.delete(text);\n                    btnElement.classList.remove('chosen');\n                } else {\n                    selectedOptions.add(text);\n                    btnElement.classList.add('chosen');\n                }\n                updateSubmitButton();\n            }\n\n            function updateSubmitButton() {\n                if (selectedOptions.size > 0) {\n                    submitBtn.classList.add('show');\n                    submitBtn.textContent = `确认 (${selectedOptions.size})`;\n                } else {\n                    submitBtn.classList.remove('show');\n                }\n            }\n\n            document.getElementById('reset-btn').addEventListener('click', () => {\n                selectedOptions.clear();\n                document.querySelectorAll('.option-button').forEach(btn => btn.classList.remove('chosen'));\n                updateSubmitButton();\n                showToast(\"已重置选项\");\n            });\n\n            document.getElementById('submit-btn').addEventListener('click', () => {\n                if (selectedOptions.size === 0) return;\n                const textToSend = Array.from(selectedOptions).join('\\n');\n                sendToInput(textToSend);\n            });\n\n            document.getElementById('clear-input-btn').addEventListener('click', () => {\n                try {\n                    const textarea = window.top.document.querySelector('#send_textarea');\n                    if (textarea) {\n                        textarea.value = '';\n                        textarea.dispatchEvent(new Event('input', { bubbles: true }));\n                        showToast(\"输入框已清空\");\n                    } else { showToast(\"未找到输入框\"); }\n                } catch (e) { showToast(\"权限受限\"); }\n            });\n\n            function sendToInput(text) {\n                try {\n                    const textarea = window.top.document.querySelector('#send_textarea');\n                    if (textarea) {\n                        textarea.value = text;\n                        textarea.dispatchEvent(new Event('input', { bubbles: true }));\n                        showToast(\"内容已填入\");\n                    } else { console.log(text); }\n                } catch (e) { console.error(e); }\n            }\n\n            let toastTimer;\n            function showToast(msg) {\n                toastEl.textContent = msg;\n                toastEl.classList.add('active');\n                clearTimeout(toastTimer);\n                toastTimer = setTimeout(() => toastEl.classList.remove('active'), 1500);\n            }\n\n            // --- 启动 ---\n            populateOptionsFromRawData();\n        });\n    </script>\n</body>\n</html>\n```",
        "trimStrings": [],
        "placement": [
            2
        ],
        "disabled": false,
        "markdownOnly": true,
        "promptOnly": false,
        "runOnEdit": true,
        "substituteRegex": 0,
        "minDepth": null,
        "maxDepth": 10
    }
]